<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>ন্যাপ ফিজিক্স কেয়ার সেন্টার - আলটিমেট অ্যাডভান্সড ম্যানেজমেন্ট সিস্টেম</title>
    
    <!-- ফন্ট অ্যাওসাম 6 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <!-- মোমেন্ট জেএস -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/locale/bn.js"></script>
    
    <!-- চার্ট.জেএস (অ্যানালিটিক্সের জন্য) -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    
    <!-- অ্যানিমেট.সিএসএস (প্রো অ্যানিমেশন) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    
    <!-- গুগল ফন্ট - আলটিমেট টাইপোগ্রাফি -->
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@300;400;500;600;700&family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        /* ========== আলটিমেট ভ্যারিয়েবল ========== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* প্রাইমারি কালার স্কিম - আলটিমেট গ্রেডিয়েন্ট */
            --primary-100: #cffafe;
            --primary-200: #a5f3fc;
            --primary-300: #67e8f9;
            --primary-400: #22d3ee;
            --primary-500: #06b6d4;
            --primary-600: #0891b2;
            --primary-700: #0e7490;
            --primary-800: #155e75;
            --primary-900: #164e63;
            
            /* সেকেন্ডারি কালার - রয়্যাল পার্পল */
            --secondary-100: #ede9fe;
            --secondary-200: #ddd6fe;
            --secondary-300: #c4b5fd;
            --secondary-400: #a78bfa;
            --secondary-500: #8b5cf6;
            --secondary-600: #7c3aed;
            --secondary-700: #6d28d9;
            --secondary-800: #5b21b6;
            --secondary-900: #4c1d95;
            
            /* একসেন্ট কালার - গোল্ডেন */
            --accent-100: #fef9c3;
            --accent-200: #fef08a;
            --accent-300: #fde047;
            --accent-400: #facc15;
            --accent-500: #eab308;
            --accent-600: #ca8a04;
            --accent-700: #a16207;
            --accent-800: #854d0e;
            --accent-900: #713f12;
            
            /* সাকসেস/এরর/ওয়ার্নিং */
            --success: #10b981;
            --success-dark: #059669;
            --warning: #f59e0b;
            --warning-dark: #d97706;
            --danger: #ef4444;
            --danger-dark: #dc2626;
            --info: #3b82f6;
            --info-dark: #2563eb;
            
            /* নিউট্রাল */
            --dark: #0f172a;
            --darker: #020617;
            --light: #f8fafc;
            --lighter: #ffffff;
            --gray-100: #f1f5f9;
            --gray-200: #e2e8f0;
            --gray-300: #cbd5e1;
            --gray-400: #94a3b8;
            --gray-500: #64748b;
            --gray-600: #475569;
            --gray-700: #334155;
            --gray-800: #1e293b;
            --gray-900: #0f172a;
            
            /* গ্লাসমর্ফিজম */
            --glass-bg: rgba(255, 255, 255, 0.25);
            --glass-border: rgba(255, 255, 255, 0.18);
            --glass-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
            --glass-blur: blur(8px);
            
            /* নিওমর্ফিজম */
            --neomorph-shadow: 20px 20px 60px #d1d9e6, -20px -20px 60px #ffffff;
            --neomorph-inset: inset 5px 5px 10px #d1d9e6, inset -5px -5px 10px #ffffff;
            
            /* অ্যানিমেশন টাইমিং */
            --transition-fast: 0.2s ease;
            --transition-normal: 0.3s ease;
            --transition-slow: 0.5s ease;
            --transition-extra-slow: 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        /* ========== বেস স্টাইল ========== */
        body {
            font-family: 'Hind Siliguri', 'Poppins', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* কাস্টম স্ক্রলবার */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--gray-200);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, var(--primary-600), var(--secondary-600));
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, var(--primary-700), var(--secondary-700));
        }

        /* ========== আলটিমেট কীফ্রেম অ্যানিমেশন ========== */
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            25% { transform: translateY(-20px) rotate(2deg); }
            75% { transform: translateY(20px) rotate(-2deg); }
        }

        @keyframes float-slow {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-15px); }
        }

        @keyframes pulse-glow {
            0%, 100% { filter: drop-shadow(0 0 5px rgba(139, 92, 246, 0.5)); }
            50% { filter: drop-shadow(0 0 30px rgba(139, 92, 246, 0.9)); }
        }

        @keyframes rotate-3d {
            0% { transform: perspective(1000px) rotateY(0deg); }
            100% { transform: perspective(1000px) rotateY(360deg); }
        }

        @keyframes tilt-shake {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(5deg); }
            75% { transform: rotate(-5deg); }
        }

        @keyframes gradient-shift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes shimmer-pro {
            0% { background-position: -1000px 0; }
            100% { background-position: 1000px 0; }
        }

        @keyframes scale-bounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        @keyframes slide-in-blurred {
            0% { transform: translateX(1000px) scaleX(2.5) scaleY(0.2); transform-origin: 0% 50%; filter: blur(40px); opacity: 0; }
            100% { transform: translateX(0) scaleY(1) scaleX(1); transform-origin: 50% 50%; filter: blur(0); opacity: 1; }
        }

        @keyframes slide-out-blurred {
            0% { transform: translateX(0) scaleY(1) scaleX(1); transform-origin: 50% 50%; filter: blur(0); opacity: 1; }
            100% { transform: translateX(1000px) scaleX(2.5) scaleY(0.2); transform-origin: 0% 50%; filter: blur(40px); opacity: 0; }
        }

        @keyframes swirl-in-fwd {
            0% { transform: rotate(-540deg) scale(0); opacity: 0; }
            100% { transform: rotate(0) scale(1); opacity: 1; }
        }

        @keyframes text-pop-up {
            0% { transform: translateY(0); text-shadow: 0 0 #555, 0 0 #444, 0 0 #333, 0 0 #222, 0 0 #111, 0 0 #000; }
            50% { transform: translateY(-10px); text-shadow: 0 10px #555, 0 20px #444, 0 30px #333, 0 40px #222, 0 50px #111, 0 60px #000; }
            100% { transform: translateY(0); text-shadow: 0 0 #555, 0 0 #444, 0 0 #333, 0 0 #222, 0 0 #111, 0 0 #000; }
        }

        /* পার্টিকেল ইফেক্ট */
        .particle {
            position: fixed;
            width: 10px;
            height: 10px;
            background: rgba(255,255,255,0.3);
            border-radius: 50%;
            pointer-events: none;
            z-index: 9999;
            animation: float 10s linear infinite;
        }

        /* লগইন পেজ - আলটিমেট */
        .login-page {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            position: relative;
            overflow: hidden;
        }

        .login-page::before {
            content: '';
            position: absolute;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, 
                rgba(255,255,255,0.1) 0%, 
                rgba(255,255,255,0.2) 25%, 
                transparent 50%,
                rgba(255,255,255,0.1) 75%,
                transparent 100%);
            animation: gradient-shift 10s linear infinite;
            transform: rotate(45deg);
        }

        .login-container {
            width: 100%;
            max-width: 500px;
            position: relative;
            z-index: 10;
            animation: slide-in-blurred 0.8s cubic-bezier(0.23, 1, 0.32, 1) forwards;
        }

        .login-card {
            background: var(--glass-bg);
            backdrop-filter: var(--glass-blur);
            -webkit-backdrop-filter: var(--glass-blur);
            border: 1px solid var(--glass-border);
            border-radius: 50px;
            padding: 50px 40px;
            box-shadow: var(--glass-shadow);
            transition: all var(--transition-normal);
            position: relative;
            overflow: hidden;
        }

        .login-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.2) 0%, transparent 70%);
            animation: rotate-3d 20s linear infinite;
        }

        .login-card:hover {
            transform: scale(1.02) translateY(-10px);
            box-shadow: 0 30px 60px rgba(0,0,0,0.3);
        }

        .logo {
            width: 150px;
            height: 150px;
            background: linear-gradient(135deg, var(--primary-500), var(--secondary-500), var(--accent-500));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 30px;
            animation: float 6s ease-in-out infinite, pulse-glow 2s ease-in-out infinite;
            position: relative;
        }

        .logo::after {
            content: '';
            position: absolute;
            width: 130%;
            height: 130%;
            border: 2px solid rgba(255,255,255,0.5);
            border-radius: 50%;
            animation: scale-bounce 3s ease-in-out infinite;
        }

        .logo i {
            font-size: 70px;
            color: white;
            filter: drop-shadow(0 0 10px rgba(255,255,255,0.8));
            animation: tilt-shake 5s ease-in-out infinite;
        }

        .login-header h1 {
            font-size: 36px;
            font-weight: 800;
            text-align: center;
            background: linear-gradient(135deg, #fff, var(--accent-300));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 5px;
            letter-spacing: 1px;
            animation: text-pop-up 1.5s ease-out;
        }

        .login-header p {
            text-align: center;
            color: rgba(255,255,255,0.9);
            font-size: 16px;
            margin-bottom: 30px;
            font-weight: 500;
        }

        .login-tab {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            background: rgba(255,255,255,0.2);
            padding: 5px;
            border-radius: 50px;
        }

        .login-tab button {
            flex: 1;
            padding: 15px;
            border: none;
            background: transparent;
            border-radius: 50px;
            font-size: 18px;
            font-weight: 600;
            color: white;
            cursor: pointer;
            transition: all var(--transition-normal);
            position: relative;
            overflow: hidden;
        }

        .login-tab button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255,255,255,0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .login-tab button:hover::before {
            width: 300px;
            height: 300px;
        }

        .login-tab button.active {
            background: linear-gradient(135deg, var(--primary-600), var(--secondary-600));
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
            transform: scale(1.05);
        }

        /* ড্যাশবোর্ড - আলটিমেট */
        .dashboard {
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
            display: none;
        }

        .dashboard::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 30%, rgba(102, 126, 234, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(118, 75, 162, 0.15) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }

        /* হেডার - আলটিমেট */
        .dashboard-header {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            padding: 20px 40px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid rgba(255,255,255,0.3);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 30px;
        }

        .header-title {
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 24px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary-700), var(--secondary-700));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .header-title i {
            font-size: 32px;
            background: linear-gradient(135deg, var(--primary-500), var(--secondary-500));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: float 3s ease-in-out infinite;
        }

        .current-time {
            font-size: 20px;
            font-weight: 600;
            background: linear-gradient(135deg, var(--primary-600), var(--secondary-600));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-family: 'Courier New', monospace;
            letter-spacing: 2px;
        }

        .header-actions {
            display: flex;
            gap: 15px;
        }

        .header-btn {
            width: 50px;
            height: 50px;
            border: none;
            border-radius: 25px;
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            color: var(--gray-700);
            cursor: pointer;
            transition: all var(--transition-normal);
            font-size: 20px;
            position: relative;
            overflow: hidden;
        }

        .header-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255,255,255,0.5);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .header-btn:hover {
            background: linear-gradient(135deg, var(--primary-600), var(--secondary-600));
            color: white;
            transform: rotate(360deg) scale(1.1);
        }

        .header-btn:hover::before {
            width: 100px;
            height: 100px;
        }

        /* কন্টেন্ট এরিয়া */
        .content-area {
            max-width: 1600px;
            margin: 0 auto;
            padding: 40px;
            padding-bottom: 120px;
            position: relative;
            z-index: 10;
        }

        /* প্রোফাইল কার্ড - আলটিমেট */
        .profile-card {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            border-radius: 60px 60px 60px 60px;
            padding: 50px;
            margin-bottom: 40px;
            box-shadow: 0 30px 60px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
            transition: all var(--transition-normal);
            border: 1px solid rgba(255,255,255,0.3);
        }

        .profile-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, 
                transparent 30%, 
                rgba(255,255,255,0.1) 50%,
                transparent 70%);
            animation: shimmer-pro 5s linear infinite;
        }

        .profile-card:hover {
            transform: translateY(-15px) scale(1.02);
            box-shadow: 0 50px 100px rgba(0,0,0,0.2);
        }

        .profile-avatar {
            width: 150px;
            height: 150px;
            background: linear-gradient(135deg, var(--primary-500), var(--secondary-500), var(--accent-500));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 25px;
            border: 5px solid white;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            animation: float-slow 4s ease-in-out infinite;
            position: relative;
        }

        .profile-avatar::after {
            content: '';
            position: absolute;
            width: 120%;
            height: 120%;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            animation: scale-bounce 3s ease-in-out infinite;
        }

        .profile-avatar i {
            font-size: 70px;
            color: white;
            filter: drop-shadow(0 0 20px rgba(255,255,255,0.5));
        }

        .profile-name {
            font-size: 36px;
            font-weight: 800;
            text-align: center;
            background: linear-gradient(135deg, var(--primary-700), var(--secondary-700));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .profile-id {
            text-align: center;
            color: var(--gray-600);
            font-size: 18px;
            margin-bottom: 5px;
            font-weight: 500;
        }

        /* স্ট্যাটস গ্রিড - আলটিমেট */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin: 40px 0;
        }

        .stat-card {
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(10px);
            border-radius: 40px;
            padding: 30px;
            display: flex;
            align-items: center;
            gap: 25px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            transition: all var(--transition-normal);
            border: 1px solid rgba(255,255,255,0.3);
            position: relative;
            overflow: hidden;
            animation: slide-in-blurred 0.5s ease-out forwards;
            animation-fill-mode: both;
        }

        .stat-card:nth-child(1) { animation-delay: 0.1s; }
        .stat-card:nth-child(2) { animation-delay: 0.2s; }
        .stat-card:nth-child(3) { animation-delay: 0.3s; }
        .stat-card:nth-child(4) { animation-delay: 0.4s; }

        .stat-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.2) 0%, transparent 70%);
            opacity: 0;
            transition: opacity var(--transition-normal);
        }

        .stat-card:hover {
            transform: translateY(-15px) scale(1.05);
            box-shadow: 0 40px 80px rgba(0,0,0,0.2);
        }

        .stat-card:hover::before {
            opacity: 1;
        }

        .stat-icon {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, var(--primary-500), var(--secondary-500));
            border-radius: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-normal);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        .stat-card:hover .stat-icon {
            transform: rotate(360deg) scale(1.1);
            border-radius: 50%;
        }

        .stat-icon i {
            font-size: 45px;
            color: white;
        }

        .stat-info h3 {
            font-size: 42px;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary-700), var(--secondary-700));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 5px;
            line-height: 1;
        }

        .stat-info p {
            color: var(--gray-600);
            font-size: 16px;
            font-weight: 500;
        }

        /* ব্যাচ বাটন - আলটিমেট */
        .batch-buttons {
            display: flex;
            gap: 20px;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .batch-btn {
            flex: 1;
            min-width: 180px;
            padding: 20px;
            border: none;
            border-radius: 40px;
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(10px);
            color: var(--gray-600);
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-normal);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.3);
        }

        .batch-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255,255,255,0.5);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .batch-btn:hover::before {
            width: 400px;
            height: 400px;
        }

        .batch-btn i {
            font-size: 24px;
            transition: all var(--transition-normal);
        }

        .batch-btn.active {
            background: linear-gradient(135deg, var(--primary-600), var(--secondary-600));
            color: white;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            transform: scale(1.05);
            animation: pulse-glow 2s infinite;
        }

        .batch-btn.active i {
            transform: rotate(360deg);
        }

        .batch-btn:hover:not(.active) {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        /* টাইমলাইন কার্ড */
        .timeline-card {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            border-radius: 60px;
            padding: 50px;
            margin-bottom: 40px;
            box-shadow: 0 30px 60px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.3);
            transition: all var(--transition-normal);
        }

        .timeline-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 50px 100px rgba(0,0,0,0.2);
        }

        /* অ্যাটেনডেন্স অ্যাকশন */
        .attendance-actions {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 25px 0;
        }

        .btn {
            padding: 18px 35px;
            border: none;
            border-radius: 40px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-normal);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            position: relative;
            overflow: hidden;
            z-index: 10;
            background: linear-gradient(135deg, var(--primary-600), var(--secondary-600));
            color: white;
            box-shadow: 0 15px 30px rgba(6, 182, 212, 0.3);
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255,255,255,0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
            z-index: -1;
        }

        .btn:hover::before {
            width: 400px;
            height: 400px;
        }

        .btn:hover {
            transform: translateY(-8px) scale(1.05);
            box-shadow: 0 30px 60px rgba(6, 182, 212, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success), var(--success-dark));
        }

        .btn-warning {
            background: linear-gradient(135deg, var(--warning), var(--warning-dark));
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--danger), var(--danger-dark));
        }

        .btn-sm {
            padding: 12px 25px;
            font-size: 14px;
        }

        .btn-block {
            width: 100%;
        }

        /* টেবিল - আলটিমেট */
        .table-container {
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(10px);
            border-radius: 40px;
            padding: 30px;
            overflow-x: auto;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.3);
        }

        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0 15px;
        }

        th {
            padding: 20px 15px;
            text-align: left;
            font-weight: 700;
            font-size: 16px;
            color: var(--gray-800);
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            border-radius: 20px 20px 0 0;
        }

        td {
            padding: 20px 15px;
            background: white;
            border-radius: 20px;
            color: var(--gray-700);
            font-weight: 500;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            transition: all var(--transition-normal);
        }

        tr {
            transition: all var(--transition-normal);
        }

        tr:hover td {
            transform: scale(1.02);
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            background: linear-gradient(135deg, #f8fafc, #ffffff);
        }

        /* স্ট্যাটাস ব্যাজ - আলটিমেট */
        .status-badge {
            display: inline-block;
            padding: 10px 20px;
            border-radius: 40px;
            font-size: 14px;
            font-weight: 600;
            letter-spacing: 0.5px;
            transition: all var(--transition-normal);
            cursor: pointer;
        }

        .status-badge:hover {
            transform: scale(1.1) rotate(5deg);
            filter: brightness(1.1);
        }

        .status-present {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.3);
        }

        .status-late {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            box-shadow: 0 5px 15px rgba(245, 158, 11, 0.3);
        }

        .status-absent {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
            box-shadow: 0 5px 15px rgba(239, 68, 68, 0.3);
        }

        .status-pass {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }

        .status-fail {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
        }

        .status-excellent {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
        }

        .status-info {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            color: white;
        }

        /* মেসেজ সেকশন - আলটিমেট */
        .message-section {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            border-radius: 60px;
            padding: 40px;
            margin-bottom: 40px;
            box-shadow: 0 30px 60px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.3);
            transition: all var(--transition-normal);
            position: relative;
            overflow: hidden;
        }

        .message-section::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, 
                transparent 30%, 
                rgba(255,255,255,0.1) 50%,
                transparent 70%);
            animation: shimmer-pro 8s linear infinite;
        }

        .message-section:hover {
            transform: translateY(-10px) scale(1.01);
            box-shadow: 0 50px 100px rgba(0,0,0,0.2);
        }

        .message-item {
            background: rgba(255,255,255,0.8);
            backdrop-filter: blur(5px);
            border-radius: 30px;
            padding: 25px;
            margin-bottom: 15px;
            border-left: 5px solid;
            transition: all var(--transition-normal);
            animation: slide-in-blurred 0.5s ease-out forwards;
        }

        .message-item:hover {
            transform: translateX(15px) scale(1.02);
            box-shadow: 0 15px 30px rgba(0,0,0,0.1);
        }

        .message-item.teacher {
            border-left-color: var(--primary-500);
        }

        .message-item.parent {
            border-left-color: var(--secondary-500);
        }

        .message-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            color: var(--gray-600);
        }

        .message-sender {
            font-weight: 700;
            color: var(--gray-800);
        }

        /* নোটিশ আইটেম */
        .notice-item {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border-left: 5px solid var(--accent-500);
            padding: 20px;
            border-radius: 30px;
            margin-bottom: 15px;
            font-weight: 500;
            transition: all var(--transition-normal);
            animation: slide-in-blurred 0.3s ease-out forwards;
            box-shadow: 0 10px 20px rgba(0,0,0,0.05);
        }

        .notice-item:hover {
            transform: translateX(15px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        /* কার্ড হেডার */
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .card-title {
            font-size: 28px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary-700), var(--secondary-700));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        /* চাইল্ড কার্ড - আলটিমেট */
        .child-card {
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(10px);
            border-radius: 40px;
            padding: 30px;
            display: flex;
            align-items: center;
            gap: 30px;
            margin-bottom: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            transition: all var(--transition-normal);
            border: 1px solid rgba(255,255,255,0.3);
            animation: slide-in-blurred 0.5s ease-out forwards;
        }

        .child-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 40px 80px rgba(0,0,0,0.2);
        }

        .child-avatar {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, var(--primary-500), var(--secondary-500));
            border-radius: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 42px;
            font-weight: 700;
            transition: all var(--transition-normal);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        .child-card:hover .child-avatar {
            transform: rotate(360deg) scale(1.1);
            border-radius: 50%;
        }

        .child-info {
            flex: 1;
        }

        .child-info h4 {
            font-size: 24px;
            font-weight: 700;
            color: var(--gray-800);
            margin-bottom: 5px;
        }

        .child-info p {
            color: var(--gray-600);
            margin: 5px 0;
        }

        /* ক্যালেন্ডার - আলটিমেট */
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
            margin: 30px 0;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255,255,255,0.8);
            backdrop-filter: blur(5px);
            border-radius: 25px;
            font-weight: 600;
            font-size: 18px;
            transition: all var(--transition-normal);
            cursor: pointer;
            border: 1px solid rgba(255,255,255,0.3);
        }

        .calendar-day:hover {
            transform: scale(1.1) rotate(5deg);
            background: linear-gradient(135deg, var(--primary-600), var(--secondary-600));
            color: white;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        .calendar-day.present {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }

        .calendar-day.absent {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
        }

        .calendar-day.late {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
        }

        .calendar-day.leave {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            color: white;
        }

        /* বটম মেনু - আলটিমেট */
        .bottom-menu {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(20px);
            display: flex;
            justify-content: center;
            padding: 15px 30px;
            border-radius: 100px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.2);
            z-index: 1000;
            border: 1px solid rgba(255,255,255,0.3);
            gap: 10px;
            animation: float-slow 3s ease-in-out infinite;
        }

        .bottom-menu-item {
            text-align: center;
            color: var(--gray-600);
            cursor: pointer;
            transition: all var(--transition-normal);
            padding: 15px 25px;
            border-radius: 50px;
            position: relative;
            overflow: hidden;
        }

        .bottom-menu-item::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(139, 92, 246, 0.1);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .bottom-menu-item:hover::before {
            width: 200px;
            height: 200px;
        }

        .bottom-menu-item i {
            display: block;
            font-size: 24px;
            margin-bottom: 5px;
            transition: all var(--transition-normal);
        }

        .bottom-menu-item span {
            font-size: 14px;
            font-weight: 600;
        }

        .bottom-menu-item.active {
            background: linear-gradient(135deg, var(--primary-600), var(--secondary-600));
            color: white;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
            transform: translateY(-5px);
        }

        .bottom-menu-item.active i {
            animation: scale-bounce 1s infinite;
        }

        /* মডাল - আলটিমেট */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            backdrop-filter: blur(15px);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.5s ease;
        }

        .modal-content {
            background: rgba(255,255,255,0.98);
            backdrop-filter: blur(20px);
            border-radius: 60px;
            padding: 50px;
            width: 90%;
            max-width: 700px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 50px 100px rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.3);
            animation: swirl-in-fwd 0.5s ease-out;
            position: relative;
        }

        .modal-content::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.2) 0%, transparent 70%);
            animation: rotate-3d 20s linear infinite;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            position: relative;
            z-index: 10;
        }

        .modal-header h3 {
            font-size: 28px;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary-700), var(--secondary-700));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 40px;
            cursor: pointer;
            color: var(--gray-500);
            transition: all var(--transition-normal);
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 25px;
        }

        .close-modal:hover {
            color: var(--danger);
            transform: rotate(360deg) scale(1.2);
            background: rgba(239, 68, 68, 0.1);
        }

        /* ফর্ম কন্ট্রোল - আলটিমেট */
        .form-group {
            margin-bottom: 25px;
            position: relative;
            z-index: 10;
        }

        .form-label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--gray-700);
            font-size: 16px;
        }

        .form-control {
            width: 100%;
            padding: 18px 20px;
            border: 2px solid var(--gray-200);
            border-radius: 30px;
            font-size: 16px;
            transition: all var(--transition-normal);
            background: white;
            font-family: 'Hind Siliguri', sans-serif;
        }

        .form-control:focus {
            border-color: var(--primary-500);
            outline: none;
            box-shadow: 0 0 0 5px rgba(6, 182, 212, 0.2);
            transform: scale(1.02);
        }

        /* ফিল্টার বার */
        .filter-bar {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        /* চার্ট কন্টেইনার */
        .chart-container {
            background: rgba(255,255,255,0.9);
            border-radius: 40px;
            padding: 30px;
            margin-bottom: 30px;
            height: 300px;
        }

        /* প্রোডাক্ট গ্রিড */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .product-card {
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(10px);
            border-radius: 30px;
            padding: 25px;
            text-align: center;
            transition: all var(--transition-normal);
            cursor: pointer;
        }

        .product-card:hover {
            transform: translateY(-10px) scale(1.05);
            box-shadow: 0 30px 60px rgba(0,0,0,0.2);
        }

        .product-icon {
            font-size: 60px;
            margin-bottom: 15px;
        }

        .product-name {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .product-price {
            color: var(--primary-600);
            font-weight: 700;
            font-size: 24px;
        }

        /* প্রগ্রেস বার */
        .progress-bar {
            width: 100%;
            height: 12px;
            background: var(--gray-200);
            border-radius: 6px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, var(--primary-500), var(--secondary-500));
            border-radius: 6px;
            transition: width 0.5s ease;
            position: relative;
            overflow: hidden;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255,255,255,0.3), 
                transparent);
            animation: shimmer-pro 2s linear infinite;
        }

        /* টুলটিপ */
        [data-tooltip] {
            position: relative;
            cursor: help;
        }

        [data-tooltip]:before {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            padding: 12px 20px;
            background: linear-gradient(135deg, var(--primary-700), var(--secondary-700));
            color: white;
            border-radius: 30px;
            font-size: 14px;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all var(--transition-normal);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
            font-weight: 500;
            z-index: 100;
        }

        [data-tooltip]:hover:before {
            opacity: 1;
            visibility: visible;
            transform: translateX(-50%) translateY(-10px);
        }

        /* টোস্ট নোটিফিকেশন */
        .notification-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            width: calc(100% - 32px);
            max-width: 300px;
        }

        .notification {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            border-radius: 50px;
            padding: 15px 25px;
            margin-bottom: 10px;
            color: var(--gray-800);
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
            font-weight: 500;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            animation: slide-in-blurred 0.3s ease-out;
            border-left: 5px solid;
        }

        .notification.success { border-left-color: var(--success); }
        .notification.error { border-left-color: var(--danger); }
        .notification.warning { border-left-color: var(--warning); }
        .notification.info { border-left-color: var(--info); }

        /* রেসপনসিভ ডিজাইন */
        @media (max-width: 1200px) {
            .stats-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (max-width: 992px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .content-area {
                padding: 30px;
            }
            
            .batch-buttons {
                flex-wrap: wrap;
            }
            
            .batch-btn {
                min-width: 140px;
            }
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .header-title span {
                display: none;
            }
            
            .current-time {
                font-size: 16px;
            }
            
            .bottom-menu {
                padding: 10px 20px;
                width: 95%;
            }
            
            .bottom-menu-item {
                padding: 10px 15px;
            }
            
            .bottom-menu-item span {
                font-size: 12px;
            }
            
            .content-area {
                padding: 20px;
                padding-bottom: 100px;
            }
            
            .profile-card {
                padding: 30px;
            }
            
            .profile-avatar {
                width: 100px;
                height: 100px;
            }
            
            .profile-name {
                font-size: 28px;
            }

            .attendance-actions {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 576px) {
            .bottom-menu-item i {
                font-size: 20px;
            }
            
            .bottom-menu-item {
                padding: 8px 12px;
            }
            
            .btn {
                padding: 15px 25px;
                font-size: 16px;
            }
            
            .modal-content {
                padding: 30px;
            }
        }
    </style>
</head>
<body>
    <!-- পার্টিকেল ইফেক্ট কন্টেইনার -->
    <div id="particles"></div>

    <!-- লগইন পেজ -->
    <div class="login-page" id="loginPage">
        <div class="login-container">
            <div class="login-card">
                <div class="logo">
                    <i class="fas fa-flask"></i>
                </div>
                <div class="login-header">
                    <h1>ন্যাপ ফিজিক্স কেয়ার</h1>
                    <p>পদার্থবিজ্ঞান কোচিং সেন্টার</p>
                    <div class="current-time" id="loginCurrentTime" style="font-size: 24px; text-align: center; margin-top: 15px; -webkit-text-fill-color: white;"></div>
                </div>

                <div class="login-tab">
                    <button class="active" onclick="switchLoginTab('student')">ছাত্র</button>
                    <button onclick="switchLoginTab('teacher')">শিক্ষক</button>
                    <button onclick="switchLoginTab('parent')">অভিভাবক</button>
                </div>

                <div id="studentLoginForm">
                    <div class="form-group">
                        <label class="form-label" style="color: white;">রোল নাম্বার</label>
                        <input type="text" class="form-control" id="studentRoll" placeholder="রোল নাম্বার দিন" value="101">
                    </div>
                    <div class="form-group">
                        <label class="form-label" style="color: white;">নাম</label>
                        <input type="text" class="form-control" id="studentNameLogin" placeholder="আপনার নাম দিন" value="রহিম মিয়া">
                    </div>
                    <button class="btn btn-primary btn-block" onclick="studentLogin()">
                        <i class="fas fa-sign-in-alt"></i> লগইন করুন
                    </button>
                </div>

                <div id="teacherLoginForm" style="display: none;">
                    <div class="form-group">
                        <label class="form-label" style="color: white;">শিক্ষক আইডি</label>
                        <input type="text" class="form-control" id="teacherId" placeholder="শিক্ষক আইডি দিন" value="TCH001">
                    </div>
                    <div class="form-group">
                        <label class="form-label" style="color: white;">পাসওয়ার্ড</label>
                        <input type="password" class="form-control" id="teacherPassword" placeholder="পাসওয়ার্ড দিন" value="teacher123">
                    </div>
                    <button class="btn btn-primary btn-block" onclick="teacherLogin()">
                        <i class="fas fa-sign-in-alt"></i> লগইন করুন
                    </button>
                </div>

                <div id="parentLoginForm" style="display: none;">
                    <div class="form-group">
                        <label class="form-label" style="color: white;">মোবাইল নাম্বার</label>
                        <input type="text" class="form-control" id="parentPhone" placeholder="মোবাইল নাম্বার দিন" value="01811111111">
                    </div>
                    <div class="form-group">
                        <label class="form-label" style="color: white;">পাসওয়ার্ড</label>
                        <input type="password" class="form-control" id="parentPassword" placeholder="পাসওয়ার্ড দিন" value="parent123">
                    </div>
                    <button class="btn btn-primary btn-block" onclick="parentLogin()">
                        <i class="fas fa-sign-in-alt"></i> লগইন করুন
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ছাত্র ড্যাশবোর্ড -->
    <div class="dashboard" id="studentDashboard">
        <div class="dashboard-header">
            <div class="header-left">
                <div class="header-title">
                    <i class="fas fa-user-graduate"></i>
                    <span id="studentDisplayName"></span>
                </div>
                <div class="current-time" id="studentHeaderTime"></div>
            </div>
            <div class="header-actions">
                <button class="header-btn" onclick="showNotification()" data-tooltip="নোটিফিকেশন">
                    <i class="fas fa-bell"></i>
                </button>
                <button class="header-btn" onclick="studentLogout()" data-tooltip="লগআউট">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
        </div>

        <div class="content-area">
            <!-- প্রোফাইল কার্ড -->
            <div class="profile-card" id="studentProfileCard">
                <div class="profile-avatar">
                    <i class="fas fa-user-astronaut"></i>
                </div>
                <div class="profile-name" id="studentFullName"></div>
                <div class="profile-id" id="studentIdDisplay"></div>
                <div class="profile-id" id="studentBatchDisplay"></div>
                <div class="profile-id" id="studentSectionDisplay"></div>
                <div class="profile-id" id="studentBloodGroup"></div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="studentPresent">0</h3>
                            <p>মোট উপস্থিতি</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-times-circle"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="studentAbsent">0</h3>
                            <p>মোট অনুপস্থিতি</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-money-bill-wave"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="studentFine">0</h3>
                            <p>বকেয়া জরিমানা</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-coins"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="studentMonthlyFee">1500</h3>
                            <p>মাসিক বেতন</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- টাইমলাইন ও চেক-ইন -->
            <div class="timeline-card">
                <div class="current-time" id="studentCurrentTime">--:--:--</div>
                
                <div class="batch-buttons">
                    <button class="batch-btn active" onclick="selectBatch('সকাল ৯টা')">
                        <i class="fas fa-sun"></i> সকাল ৯টা
                    </button>
                    <button class="batch-btn" onclick="selectBatch('সকাল ১০টা')">
                        <i class="fas fa-sun"></i> সকাল ১০টা
                    </button>
                    <button class="batch-btn" onclick="selectBatch('সকাল ১১টা')">
                        <i class="fas fa-cloud-sun"></i> সকাল ১১টা
                    </button>
                </div>

                <div class="attendance-actions">
                    <button class="btn btn-primary" onclick="studentCheckIn()">
                        <i class="fas fa-fingerprint"></i> চেক-ইন
                    </button>
                    <button class="btn btn-warning" onclick="showStudentCalendar()">
                        <i class="fas fa-calendar-alt"></i> ক্যালেন্ডার
                    </button>
                </div>

                <div class="stats-grid">
                    <div class="stat-card" onclick="studentCheckIn()" style="cursor: pointer;">
                        <div class="stat-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="studentTodayCheckIn">--:--</h3>
                            <p>আজকের চেক-ইন</p>
                        </div>
                    </div>
                    <div class="stat-card" onclick="showStudentCalendar()" style="cursor: pointer;">
                        <div class="stat-icon">
                            <i class="fas fa-calendar-check"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="studentTodayStatus">--</h3>
                            <p>আজকের অবস্থা</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="studentAttendanceRate">0%</h3>
                            <p>উপস্থিতির হার</p>
                            <div class="progress-bar">
                                <div class="progress-fill" id="attendanceProgress" style="width: 0%;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- নোটিশ বোর্ড -->
            <div class="message-section">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-bullhorn"></i> নোটিশ বোর্ড
                    </h3>
                    <button class="btn btn-sm btn-primary" onclick="refreshNotices()">
                        <i class="fas fa-sync-alt"></i> রিফ্রেশ
                    </button>
                </div>
                <div id="studentNotices"></div>
            </div>

            <!-- পরীক্ষার ফলাফল -->
            <div class="message-section">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-pencil-alt"></i> পরীক্ষার ফলাফল
                    </h3>
                    <button class="btn btn-sm btn-primary" onclick="viewAllExams()">সব দেখুন</button>
                </div>
                <div id="examResults"></div>
            </div>

            <!-- আর্থিক বিবরণী -->
            <div class="message-section">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-chart-pie"></i> আর্থিক বিবরণী
                    </h3>
                </div>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, var(--danger), #dc2626);">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="totalFineAmount">০</h3>
                            <p>মোট জরিমানা</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, var(--success), #059669);">
                            <i class="fas fa-check-double"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="paidFineAmount">০</h3>
                            <p>পরিশোধিত</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, var(--warning), #d97706);">
                            <i class="fas fa-hourglass-half"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="pendingFineAmount">০</h3>
                            <p>বকেয়া</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- শিক্ষকের বার্তা -->
            <div class="message-section">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-envelope-open-text"></i> শিক্ষকের বার্তা
                    </h3>
                    <button class="btn btn-sm btn-primary" onclick="loadStudentMessages()">
                        <i class="fas fa-sync-alt"></i> রিফ্রেশ
                    </button>
                </div>
                <div id="studentMessages"></div>
            </div>

            <!-- বটম মেনু -->
            <div class="bottom-menu">
                <div class="bottom-menu-item active" onclick="showStudentTab('home', event)">
                    <i class="fas fa-home"></i>
                    <span>হোম</span>
                </div>
                <div class="bottom-menu-item" onclick="showStudentTab('exams', event)">
                    <i class="fas fa-pencil-ruler"></i>
                    <span>পরীক্ষা</span>
                </div>
                <div class="bottom-menu-item" onclick="showStudentTab('fees', event)">
                    <i class="fas fa-coins"></i>
                    <span>ফি</span>
                </div>
                <div class="bottom-menu-item" onclick="showStudentTab('calendar', event)">
                    <i class="fas fa-calendar-check"></i>
                    <span>ক্যালেন্ডার</span>
                </div>
                <div class="bottom-menu-item" onclick="showStudentTab('messages', event)">
                    <i class="fas fa-comment-dots"></i>
                    <span>বার্তা</span>
                </div>
            </div>
        </div>
    </div>

    <!-- শিক্ষক ড্যাশবোর্ড -->
    <div class="dashboard" id="teacherDashboard">
        <div class="dashboard-header">
            <div class="header-left">
                <div class="header-title">
                    <i class="fas fa-chalkboard-teacher"></i>
                    <span id="teacherDisplayName"></span>
                </div>
                <div class="current-time" id="teacherHeaderTime"></div>
            </div>
            <div class="header-actions">
                <button class="header-btn" onclick="showNotification()" data-tooltip="নোটিফিকেশন">
                    <i class="fas fa-bell"></i>
                </button>
                <button class="header-btn" onclick="teacherLogout()" data-tooltip="লগআউট">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
        </div>

        <div class="content-area">
            <!-- স্ট্যাটস কার্ড -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="totalStudents">০</h3>
                        <p>মোট ছাত্র</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, var(--success), #059669);">
                        <i class="fas fa-user-check"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="todayPresent">০</h3>
                        <p>আজ উপস্থিত</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, var(--danger), #dc2626);">
                        <i class="fas fa-user-clock"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="todayAbsent">০</h3>
                        <p>আজ অনুপস্থিত</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, var(--warning), #d97706);">
                        <i class="fas fa-hand-holding-usd"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="totalFines">৳০</h3>
                        <p>মোট জরিমানা</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, var(--info), #2563eb);">
                        <i class="fas fa-chart-pie"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="attendancePercentage">0%</h3>
                        <p>উপস্থিতির হার</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, var(--accent-500), #ca8a04);">
                        <i class="fas fa-crown"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="totalExcellent">০</h3>
                        <p>১০ এ ১০ প্রাপ্ত</p>
                    </div>
                </div>
            </div>

            <!-- ব্যাচ নির্বাচন ও অ্যাকশন -->
            <div class="timeline-card">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-layer-group"></i> ব্যাচ ব্যবস্থাপনা
                    </h3>
                    <div style="display: flex; gap: 15px;">
                        <button class="btn btn-sm btn-success" onclick="showAddStudentModal()">
                            <i class="fas fa-user-plus"></i> নতুন ছাত্র
                        </button>
                        <button class="btn btn-sm btn-primary" onclick="takeAttendance()">
                            <i class="fas fa-camera"></i> উপস্থিতি নিন
                        </button>
                    </div>
                </div>
                
                <div class="batch-buttons">
                    <button class="batch-btn active" onclick="selectTeacherBatch('সকাল ৯টা')">
                        <i class="fas fa-clock"></i> সকাল ৯টা
                    </button>
                    <button class="batch-btn" onclick="selectTeacherBatch('সকাল ১০টা')">
                        <i class="fas fa-clock"></i> সকাল ১০টা
                    </button>
                    <button class="batch-btn" onclick="selectTeacherBatch('সকাল ১১টা')">
                        <i class="fas fa-clock"></i> সকাল ১১টা
                    </button>
                    <button class="batch-btn" onclick="selectTeacherBatch('বিকাল ৩টা')">
                        <i class="fas fa-clock"></i> বিকাল ৩টা
                    </button>
                    <button class="batch-btn" onclick="selectTeacherBatch('বিকাল ৪টা')">
                        <i class="fas fa-clock"></i> বিকাল ৪টা
                    </button>
                </div>

                <div class="filter-bar" style="margin-top: 30px;">
                    <input type="text" class="form-control" id="searchStudent" placeholder="🔍 ছাত্র খুঁজুন..." onkeyup="searchStudents()">
                    <button class="btn btn-primary" onclick="exportStudentList()">
                        <i class="fas fa-file-export"></i> এক্সপোর্ট
                    </button>
                </div>
            </div>

            <!-- ছাত্র তালিকা -->
            <div class="message-section">
                <h2 style="font-size: 28px; font-weight: 700; background: linear-gradient(135deg, var(--primary-700), var(--secondary-700)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 25px;">
                    <i class="fas fa-users"></i> ছাত্র তালিকা - <span id="selectedBatch">সকাল ৯টা ব্যাচ</span>
                </h2>
                
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>রোল</th>
                                <th>ছাত্র</th>
                                <th>সেকশন</th>
                                <th>মোবাইল</th>
                                <th>উপস্থিতি</th>
                                <th>জরিমানা</th>
                                <th>পরীক্ষা</th>
                                <th>অ্যাকশন</th>
                            </tr>
                        </thead>
                        <tbody id="studentsList"></tbody>
                    </table>
                </div>
            </div>

            <!-- কুইক অ্যাটেনডেন্স -->
            <div class="message-section">
                <h2 style="font-size: 28px; font-weight: 700; background: linear-gradient(135deg, var(--primary-700), var(--secondary-700)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 25px;">
                    <i class="fas fa-bolt"></i> দ্রুত উপস্থিতি
                </h2>
                
                <div class="attendance-actions" style="grid-template-columns: repeat(4, 1fr);">
                    <button class="btn btn-success" onclick="quickAttendance('present')">
                        <i class="fas fa-check-circle"></i> সবাই উপস্থিত
                    </button>
                    <button class="btn btn-warning" onclick="quickAttendance('late')">
                        <i class="fas fa-clock"></i> সবাই দেরিতে
                    </button>
                    <button class="btn btn-danger" onclick="quickAttendance('absent')">
                        <i class="fas fa-times-circle"></i> সবাই অনুপস্থিত
                    </button>
                    <button class="btn btn-primary" onclick="takeAttendance()">
                        <i class="fas fa-edit"></i> কাস্টম
                    </button>
                </div>
            </div>

            <!-- পরীক্ষার নম্বর দেওয়ার ফর্ম -->
            <div class="message-section">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-pencil-ruler"></i> পরীক্ষার নম্বর দিন
                    </h3>
                    <button class="btn btn-primary" onclick="showExamMarksModal()">
                        <i class="fas fa-plus-circle"></i> নম্বর দিন
                    </button>
                </div>
                <div id="recentExams"></div>
            </div>

            <!-- জরিমানা ব্যবস্থাপনা -->
            <div class="message-section">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-coins"></i> জরিমানা ব্যবস্থাপনা
                    </h3>
                    <button class="btn btn-warning" onclick="showFineSettings()">
                        <i class="fas fa-cog"></i> সেটিংস
                    </button>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-info">
                            <h3 id="totalFineCollected">৳০</h3>
                            <p>আদায়কৃত</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-info">
                            <h3 id="totalFinePending">৳০</h3>
                            <p>বকেয়া</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-info">
                            <h3 id="totalFineCount">০</h3>
                            <p>মোট জরিমানা</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- অভিভাবককে বার্তা -->
            <div class="message-section">
                <h2 style="font-size: 28px; font-weight: 700; background: linear-gradient(135deg, var(--primary-700), var(--secondary-700)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 25px;">
                    <i class="fas fa-paper-plane"></i> অভিভাবককে বার্তা পাঠান
                </h2>
                
                <div class="form-group">
                    <label class="form-label">ছাত্র নির্বাচন</label>
                    <select class="form-control" id="messageStudentSelect" onchange="updateMessageTemplate()">
                        <option value="">ছাত্র নির্বাচন করুন</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">বার্তার ধরন</label>
                    <select class="form-control" id="messageType" onchange="updateMessageTemplate()">
                        <option value="general">সাধারণ বার্তা</option>
                        <option value="attendance">উপস্থিতি সংক্রান্ত</option>
                        <option value="exam">পরীক্ষা সংক্রান্ত</option>
                        <option value="fine">জরিমানা সংক্রান্ত</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">বার্তা</label>
                    <textarea class="form-control" id="teacherMessage" rows="4" placeholder="বার্তা লিখুন..."></textarea>
                </div>
                
                <button class="btn btn-primary btn-block" onclick="sendMessageToParent()">
                    <i class="fas fa-paper-plane"></i> বার্তা পাঠান
                </button>
            </div>

            <!-- পাঠানো বার্তার ইতিহাস -->
            <div class="message-section">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-history"></i> পাঠানো বার্তার ইতিহাস
                    </h3>
                    <button class="btn btn-sm btn-primary" onclick="loadSentMessages()">
                        <i class="fas fa-sync-alt"></i> রিফ্রেশ
                    </button>
                </div>
                <div id="sentMessages"></div>
            </div>

            <!-- বটম মেনু -->
            <div class="bottom-menu">
                <div class="bottom-menu-item active" onclick="showTeacherTab('dashboard', event)">
                    <i class="fas fa-home"></i>
                    <span>হোম</span>
                </div>
                <div class="bottom-menu-item" onclick="showTeacherTab('students', event)">
                    <i class="fas fa-users"></i>
                    <span>ছাত্র</span>
                </div>
                <div class="bottom-menu-item" onclick="showTeacherTab('attendance', event)">
                    <i class="fas fa-calendar-check"></i>
                    <span>উপস্থিতি</span>
                </div>
                <div class="bottom-menu-item" onclick="showTeacherTab('exams', event)">
                    <i class="fas fa-pencil-alt"></i>
                    <span>পরীক্ষা</span>
                </div>
                <div class="bottom-menu-item" onclick="showTeacherTab('messages', event)">
                    <i class="fas fa-envelope"></i>
                    <span>বার্তা</span>
                </div>
                <div class="bottom-menu-item" onclick="showTeacherTab('fees', event)">
                    <i class="fas fa-coins"></i>
                    <span>ফি</span>
                </div>
            </div>
        </div>
    </div>

    <!-- অভিভাবক ড্যাশবোর্ড -->
    <div class="dashboard" id="parentDashboard">
        <div class="dashboard-header">
            <div class="header-left">
                <div class="header-title">
                    <i class="fas fa-users"></i>
                    <span id="parentDisplayName"></span>
                </div>
                <div class="current-time" id="parentHeaderTime"></div>
            </div>
            <div class="header-actions">
                <button class="header-btn" onclick="showNotification()" data-tooltip="নোটিফিকেশন">
                    <i class="fas fa-bell"></i>
                </button>
                <button class="header-btn" onclick="parentLogout()" data-tooltip="লগআউট">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
        </div>

        <div class="content-area">
            <!-- ওয়েলকাম কার্ড -->
            <div class="profile-card" style="background: linear-gradient(135deg, var(--primary-600), var(--secondary-600));">
                <h1 style="font-size: 42px; color: white; margin-bottom: 15px;">স্বাগতম <span id="parentWelcomeName"></span>!</h1>
                <p style="font-size: 20px; color: rgba(255,255,255,0.9);">আপনার সন্তানের শিক্ষার অগ্রগতি ট্র্যাক করুন</p>
                <div class="current-time" id="parentCurrentTime" style="color: white; margin-top: 20px; font-size: 24px;"></div>
            </div>

            <!-- সন্তানের তালিকা -->
            <div class="message-section">
                <h2 style="font-size: 28px; font-weight: 700; background: linear-gradient(135deg, var(--primary-700), var(--secondary-700)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 25px;">
                    <i class="fas fa-child"></i> আমার সন্তানের তথ্য
                </h2>
                <div id="childrenList"></div>
            </div>

            <!-- শিক্ষকের বার্তা -->
            <div class="message-section">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-envelope"></i> শিক্ষকের বার্তা
                    </h3>
                    <button class="btn btn-sm btn-primary" onclick="loadParentMessages()">
                        <i class="fas fa-sync-alt"></i> রিফ্রেশ
                    </button>
                </div>
                <div id="parentMessages"></div>
            </div>

            <!-- আর্থিক সারাংশ -->
            <div class="message-section">
                <h2 style="font-size: 28px; font-weight: 700; background: linear-gradient(135deg, var(--primary-700), var(--secondary-700)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 25px;">
                    <i class="fas fa-chart-pie"></i> আর্থিক সারাংশ
                </h2>
                <div class="stats-grid" id="parentFinancialSummary"></div>
            </div>

            <!-- বটম মেনু -->
            <div class="bottom-menu">
                <div class="bottom-menu-item active" onclick="showParentTab('home', event)">
                    <i class="fas fa-home"></i>
                    <span>হোম</span>
                </div>
                <div class="bottom-menu-item" onclick="showParentTab('children', event)">
                    <i class="fas fa-child"></i>
                    <span>সন্তান</span>
                </div>
                <div class="bottom-menu-item" onclick="showParentTab('messages', event)">
                    <i class="fas fa-envelope"></i>
                    <span>বার্তা</span>
                </div>
                <div class="bottom-menu-item" onclick="showParentTab('results', event)">
                    <i class="fas fa-chart-bar"></i>
                    <span>ফলাফল</span>
                </div>
                <div class="bottom-menu-item" onclick="showParentTab('fees', event)">
                    <i class="fas fa-coins"></i>
                    <span>ফি</span>
                </div>
                <div class="bottom-menu-item" onclick="showParentTab('calendar', event)">
                    <i class="fas fa-calendar-alt"></i>
                    <span>ক্যালেন্ডার</span>
                </div>
            </div>
        </div>
    </div>

    <!-- অ্যাড স্টুডেন্ট মডাল -->
    <div class="modal" id="addStudentModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-user-plus"></i> নতুন ছাত্র ভর্তি</h3>
                <button class="close-modal" onclick="closeModal('addStudentModal')">&times;</button>
            </div>
            <form id="addStudentForm" onsubmit="saveStudent(event)">
                <div class="form-group">
                    <label class="form-label">ছাত্রের নাম <span style="color: var(--danger);">*</span></label>
                    <input type="text" class="form-control" id="studentName" required>
                </div>
                <div class="form-group">
                    <label class="form-label">রোল নাম্বার <span style="color: var(--danger);">*</span></label>
                    <input type="text" class="form-control" id="studentRoll" required>
                </div>
                <div class="form-group">
                    <label class="form-label">মোবাইল নাম্বার <span style="color: var(--danger);">*</span></label>
                    <input type="tel" class="form-control" id="studentPhone" required>
                </div>
                <div class="form-group">
                    <label class="form-label">হোয়াটসঅ্যাপ</label>
                    <input type="tel" class="form-control" id="studentWhatsapp">
                </div>
                <div class="form-group">
                    <label class="form-label">ইমেইল</label>
                    <input type="email" class="form-control" id="studentEmail">
                </div>
                <div class="form-group">
                    <label class="form-label">ব্লাড গ্রুপ</label>
                    <select class="form-control" id="studentBloodGroup">
                        <option value="A+">A+</option>
                        <option value="A-">A-</option>
                        <option value="B+">B+</option>
                        <option value="B-">B-</option>
                        <option value="O+">O+</option>
                        <option value="O-">O-</option>
                        <option value="AB+">AB+</option>
                        <option value="AB-">AB-</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">এসএসসি জিপিএ</label>
                    <input type="number" step="0.01" min="0" max="5" class="form-control" id="studentSscGpa">
                </div>
                <div class="form-group">
                    <label class="form-label">ব্যাচ <span style="color: var(--danger);">*</span></label>
                    <select class="form-control" id="studentBatch" required>
                        <option value="সকাল ৯টা">সকাল ৯টা</option>
                        <option value="সকাল ১০টা">সকাল ১০টা</option>
                        <option value="সকাল ১১টা">সকাল ১১টা</option>
                        <option value="বিকাল ৩টা">বিকাল ৩টা</option>
                        <option value="বিকাল ৪টা">বিকাল ৪টা</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">সেকশন</label>
                    <select class="form-control" id="studentSection" required>
                        <option value="A">A</option>
                        <option value="B">B</option>
                        <option value="C">C</option>
                        <option value="D">D</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">পিতার নাম</label>
                    <input type="text" class="form-control" id="parentName">
                </div>
                <div class="form-group">
                    <label class="form-label">পিতার মোবাইল</label>
                    <input type="tel" class="form-control" id="parentPhone">
                </div>
                <div class="form-group">
                    <label class="form-label">মাতার নাম</label>
                    <input type="text" class="form-control" id="motherName">
                </div>
                <div class="form-group">
                    <label class="form-label">মাতার মোবাইল</label>
                    <input type="tel" class="form-control" id="motherPhone">
                </div>
                <div class="form-group">
                    <label class="form-label">ঠিকানা</label>
                    <textarea class="form-control" id="studentAddress" rows="2"></textarea>
                </div>
                <button type="submit" class="btn btn-primary btn-block">ছাত্র ভর্তি করুন</button>
            </form>
        </div>
    </div>

    <!-- পরীক্ষার নম্বর দেওয়ার মডাল -->
    <div class="modal" id="examMarksModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-pencil-alt"></i> পরীক্ষার নম্বর দিন</h3>
                <button class="close-modal" onclick="closeModal('examMarksModal')">&times;</button>
            </div>
            <div class="form-group">
                <label class="form-label">পরীক্ষার নাম</label>
                <input type="text" class="form-control" id="examName" value="পদার্থবিজ্ঞান">
            </div>
            <div class="form-group">
                <label class="form-label">তারিখ</label>
                <input type="date" class="form-control" id="examDate">
            </div>
            <div class="form-group">
                <label class="form-label">পূর্ণ নম্বর</label>
                <input type="number" class="form-control" id="examTotalMarks" value="10">
            </div>
            <div class="table-container" style="max-height: 400px; overflow-y: auto;">
                <table>
                    <thead>
                        <tr>
                            <th>ছাত্র</th>
                            <th>রোল</th>
                            <th>প্রাপ্ত নম্বর</th>
                            <th>অনুপস্থিত</th>
                        </tr>
                    </thead>
                    <tbody id="examMarksList"></tbody>
                </table>
            </div>
            <div style="display: flex; gap: 10px; margin: 20px 0; flex-wrap: wrap;">
                <button class="btn btn-success" onclick="markAllPass()">সবাই পাস</button>
                <button class="btn btn-warning" onclick="markAllAverage()">সবাই ৭</button>
                <button class="btn btn-danger" onclick="markAllAbsentExam()">সবাই অনুপস্থিত</button>
            </div>
            <button class="btn btn-primary btn-block" onclick="saveExamMarks()">সংরক্ষণ করুন</button>
        </div>
    </div>

    <!-- উপস্থিতি নেওয়ার মডাল -->
    <div class="modal" id="attendanceModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-calendar-check"></i> উপস্থিতি নিন - <span id="attendanceBatch"></span></h3>
                <button class="close-modal" onclick="closeModal('attendanceModal')">&times;</button>
            </div>
            <div class="form-group">
                <label class="form-label">তারিখ</label>
                <input type="date" class="form-control" id="attendanceDate">
            </div>
            <div class="form-group">
                <label class="form-label">দিন</label>
                <input type="text" class="form-control" id="attendanceDay" readonly>
            </div>
            <div class="table-container" style="max-height: 400px; overflow-y: auto;">
                <table>
                    <thead>
                        <tr>
                            <th>ছাত্র</th>
                            <th>রোল</th>
                            <th>উপস্থিতি</th>
                        </tr>
                    </thead>
                    <tbody id="attendanceList"></tbody>
                </table>
            </div>
            <div style="display: flex; gap: 10px; margin: 20px 0; flex-wrap: wrap;">
                <button class="btn btn-success" onclick="markAllPresent()">সবাই উপস্থিত</button>
                <button class="btn btn-warning" onclick="markAllLate()">সবাই দেরিতে</button>
                <button class="btn btn-danger" onclick="markAllAbsent()">সবাই অনুপস্থিত</button>
            </div>
            <button class="btn btn-primary btn-block" onclick="saveAttendance()">সংরক্ষণ করুন</button>
        </div>
    </div>

    <!-- জরিমানা পরিশোধের মডাল -->
    <div class="modal" id="payFineModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-hand-holding-usd"></i> জরিমানা পরিশোধ</h3>
                <button class="close-modal" onclick="closeModal('payFineModal')">&times;</button>
            </div>
            <div class="form-group">
                <label class="form-label">ছাত্রের নাম</label>
                <input type="text" class="form-control" id="fineStudentName" readonly>
            </div>
            <div class="form-group">
                <label class="form-label">জরিমানার বিবরণ</label>
                <div id="fineDetails" style="background: #f8fafc; padding: 20px; border-radius: 20px;"></div>
            </div>
            <div class="form-group">
                <label class="form-label">মোট জরিমানা</label>
                <input type="text" class="form-control" id="fineAmount" readonly>
            </div>
            <div class="form-group">
                <label class="form-label">পরিশোধের তারিখ</label>
                <input type="text" class="form-control" id="paymentDate" readonly>
            </div>
            <div class="form-group">
                <label class="form-label">পদ্ধতি</label>
                <select class="form-control" id="paymentMethod">
                    <option value="cash">নগদ</option>
                    <option value="bkash">বিকাশ</option>
                    <option value="nagad">নগদ</option>
                    <option value="bank">ব্যাংক</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">ট্রানজেকশন আইডি</label>
                <input type="text" class="form-control" id="transactionId" placeholder="ট্রানজেকশন আইডি">
            </div>
            <div style="display: flex; gap: 10px;">
                <button class="btn btn-success" onclick="payFine()">পরিশোধ নিশ্চিত করুন</button>
                <button class="btn btn-warning" onclick="payPartialFine()">আংশিক পরিশোধ</button>
            </div>
        </div>
    </div>

    <!-- ক্যালেন্ডার মডাল -->
    <div class="modal" id="calendarModal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h3><i class="fas fa-calendar-alt"></i> <span id="calendarTitle"></span></h3>
                <button class="close-modal" onclick="closeModal('calendarModal')">&times;</button>
            </div>
            <div style="display: flex; gap: 20px; margin-bottom: 30px;">
                <select class="form-control" id="calendarMonth" onchange="updateCalendar()">
                    <option value="0">জানুয়ারি</option>
                    <option value="1">ফেব্রুয়ারি</option>
                    <option value="2">মার্চ</option>
                    <option value="3">এপ্রিল</option>
                    <option value="4">মে</option>
                    <option value="5">জুন</option>
                    <option value="6">জুলাই</option>
                    <option value="7">আগস্ট</option>
                    <option value="8">সেপ্টেম্বর</option>
                    <option value="9">অক্টোবর</option>
                    <option value="10">নভেম্বর</option>
                    <option value="11">ডিসেম্বর</option>
                </select>
                <select class="form-control" id="calendarYear" onchange="updateCalendar()"></select>
            </div>
            <div class="calendar-grid" id="calendarGrid"></div>
            <div style="display: flex; gap: 30px; justify-content: center; margin-top: 30px;">
                <div><span style="display: inline-block; width: 25px; height: 25px; background: linear-gradient(135deg, #10b981, #059669); border-radius: 8px;"></span> উপস্থিত</div>
                <div><span style="display: inline-block; width: 25px; height: 25px; background: linear-gradient(135deg, #f59e0b, #d97706); border-radius: 8px;"></span> দেরিতে</div>
                <div><span style="display: inline-block; width: 25px; height: 25px; background: linear-gradient(135deg, #ef4444, #dc2626); border-radius: 8px;"></span> অনুপস্থিত</div>
            </div>
        </div>
    </div>

    <!-- জরিমানা সেটিংস মডাল -->
    <div class="modal" id="fineSettingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-sliders-h"></i> জরিমানা সেটিংস</h3>
                <button class="close-modal" onclick="closeModal('fineSettingsModal')">&times;</button>
            </div>
            <div class="form-group">
                <label class="form-label">সাধারণ দিনে অনুপস্থিতি (টাকা)</label>
                <input type="number" class="form-control" id="finePerAbsent" value="50">
            </div>
            <div class="form-group">
                <label class="form-label">শুক্রবারে অনুপস্থিতি (টাকা)</label>
                <input type="number" class="form-control" id="fineFridayAbsent" value="100">
            </div>
            <div class="form-group">
                <label class="form-label">পরীক্ষায় অনুপস্থিতি (টাকা)</label>
                <input type="number" class="form-control" id="finePerExamAbsent" value="200">
            </div>
            <div class="form-group">
                <label class="form-label">পরীক্ষায় ফেল (টাকা)</label>
                <input type="number" class="form-control" id="finePerExamFail" value="100">
            </div>
            <div class="form-group">
                <label class="form-label">মাসিক বেতন (টাকা)</label>
                <input type="number" class="form-control" id="monthlyFee" value="1500">
            </div>
            <button class="btn btn-primary btn-block" onclick="saveFineSettings()">সংরক্ষণ করুন</button>
        </div>
    </div>

    <!-- টোস্ট নোটিফিকেশন কন্টেইনার -->
    <div class="notification-container" id="notificationContainer"></div>

    <script>
        // ========== আলটিমেট জাভাস্ক্রিপ্ট ==========
        
        // পার্টিকেল ইফেক্ট
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            if (!particlesContainer) return;
            
            for (let i = 0; i < 50; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 10 + 's';
                particle.style.animationDuration = (Math.random() * 10 + 10) + 's';
                particle.style.width = (Math.random() * 15 + 5) + 'px';
                particle.style.height = particle.style.width;
                particlesContainer.appendChild(particle);
            }
        }

        // টোস্ট নোটিফিকেশন
        function showNotification(message, type = 'success') {
            const container = document.getElementById('notificationContainer');
            const notif = document.createElement('div');
            notif.className = `notification ${type}`;
            notif.innerHTML = `<i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'times-circle' : type === 'warning' ? 'exclamation-triangle' : 'info-circle'}"></i> ${message}`;
            container.appendChild(notif);
            
            setTimeout(() => {
                notif.style.animation = 'slide-out-blurred 0.3s ease-out forwards';
                setTimeout(() => notif.remove(), 300);
            }, 3000);
        }

        // গ্লোবাল ভেরিয়েবল
        let currentUser = null;
        let currentBatch = 'সকাল ৯টা';
        
        // সেটিংস
        let settings = {
            finePerAbsent: 50,
            fineFridayAbsent: 100,
            finePerExamAbsent: 200,
            finePerExamFail: 100,
            monthlyFee: 1500,
            passingMarks: 5
        };

        // বার্তা সংরক্ষণ
        let messages = [];

        // ছাত্রদের ডেটা
        let students = [
            { 
                id: 'STU001', 
                roll: '101',
                name: 'রহিম মিয়া', 
                phone: '01711111111',
                whatsapp: '01711111111',
                email: 'rahim@example.com',
                batch: 'সকাল ৯টা',
                section: 'A',
                bloodGroup: 'B+',
                password: '123456',
                sscGpa: '4.50',
                attendance: [
                    { date: '2024-01-07', status: 'present' },
                    { date: '2024-01-08', status: 'present' },
                    { date: '2024-01-09', status: 'late' },
                    { date: '2024-01-10', status: 'absent' }
                ],
                fines: [
                    { date: '2024-01-10', amount: 50, reason: 'অনুপস্থিতি', paid: false }
                ],
                payments: [],
                exams: [
                    { date: '2024-01-15', subject: 'পদার্থবিজ্ঞান', marks: 8, totalMarks: 10 },
                    { date: '2024-02-15', subject: 'পদার্থবিজ্ঞান', marks: 4, totalMarks: 10 }
                ],
                parentName: 'করিম মিয়া',
                parentPhone: '01811111111',
                motherName: 'আমেনা বেগম',
                motherPhone: '01911111111',
                address: 'ঢাকা'
            },
            { 
                id: 'STU002', 
                roll: '102',
                name: 'করিম হাসান', 
                phone: '01722222222',
                whatsapp: '01722222222',
                email: 'karim@example.com',
                batch: 'সকাল ৯টা',
                section: 'A',
                bloodGroup: 'O+',
                password: '123456',
                sscGpa: '5.00',
                attendance: [
                    { date: '2024-01-07', status: 'present' },
                    { date: '2024-01-08', status: 'present' },
                    { date: '2024-01-09', status: 'present' },
                    { date: '2024-01-10', status: 'present' }
                ],
                fines: [],
                payments: [],
                exams: [
                    { date: '2024-01-15', subject: 'পদার্থবিজ্ঞান', marks: 9, totalMarks: 10 },
                    { date: '2024-02-15', subject: 'পদার্থবিজ্ঞান', marks: 10, totalMarks: 10 }
                ],
                parentName: 'হাসান মিয়া',
                parentPhone: '01822222222',
                motherName: 'ফাতেমা বেগম',
                motherPhone: '01922222222',
                address: 'ঢাকা'
            },
            { 
                id: 'STU003', 
                roll: '103',
                name: 'ফাতেমা আক্তার', 
                phone: '01733333333',
                whatsapp: '01733333333',
                email: 'fatema@example.com',
                batch: 'সকাল ১০টা',
                section: 'B',
                bloodGroup: 'A+',
                password: '123456',
                sscGpa: '4.80',
                attendance: [
                    { date: '2024-01-07', status: 'present' },
                    { date: '2024-01-08', status: 'absent' },
                    { date: '2024-01-09', status: 'present' },
                    { date: '2024-01-10', status: 'absent' }
                ],
                fines: [
                    { date: '2024-01-08', amount: 50, reason: 'অনুপস্থিতি', paid: false },
                    { date: '2024-01-10', amount: 50, reason: 'অনুপস্থিতি', paid: false }
                ],
                payments: [],
                exams: [
                    { date: '2024-01-15', subject: 'পদার্থবিজ্ঞান', marks: 10, totalMarks: 10 }
                ],
                parentName: 'রফিক আহমেদ',
                parentPhone: '01833333333',
                motherName: 'সালমা বেগম',
                motherPhone: '01933333333',
                address: 'ঢাকা'
            }
        ];

        // শিক্ষকদের ডেটা
        let teachers = [
            { id: 'TCH001', name: 'তানভীর আহমেদ', phone: '01811111111', email: 'tanvir@example.com', password: 'teacher123' }
        ];

        // অভিভাবকদের ডেটা
        let parents = [
            { id: 'PAR001', name: 'করিম মিয়া', phone: '01811111111', children: ['STU001'], password: 'parent123' },
            { id: 'PAR002', name: 'হাসান মিয়া', phone: '01822222222', children: ['STU002'], password: 'parent123' },
            { id: 'PAR003', name: 'রফিক আহমেদ', phone: '01833333333', children: ['STU003'], password: 'parent123' }
        ];

        // ডকুমেন্ট রেডি
        document.addEventListener('DOMContentLoaded', function() {
            // পার্টিকেল ইফেক্ট
            createParticles();
            
            // তারিখ সেট করা
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('attendanceDate').value = today;
            document.getElementById('examDate').value = today;
            
            // ক্যালেন্ডার ইয়ার পপুলেট
            const yearSelect = document.getElementById('calendarYear');
            const currentYear = new Date().getFullYear();
            for (let i = currentYear - 2; i <= currentYear + 2; i++) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = i + ' সালে';
                if (i === currentYear) option.selected = true;
                yearSelect.appendChild(option);
            }

            // টাইম আপডেট শুরু
            updateAllTimes();
            setInterval(updateAllTimes, 1000);
        });

        // সব জায়গায় সময় আপডেট
        function updateAllTimes() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('bn-BD', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
            const dateString = now.toLocaleDateString('bn-BD', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
            
            document.getElementById('loginCurrentTime').textContent = timeString;
            
            if (document.getElementById('studentCurrentTime')) {
                document.getElementById('studentCurrentTime').textContent = timeString;
                document.getElementById('studentHeaderTime').textContent = timeString;
            }
            
            if (document.getElementById('teacherHeaderTime')) {
                document.getElementById('teacherHeaderTime').textContent = timeString;
            }
            
            if (document.getElementById('parentHeaderTime')) {
                document.getElementById('parentHeaderTime').textContent = timeString;
                document.getElementById('parentCurrentTime').textContent = dateString;
            }
            
            const attendanceDay = document.getElementById('attendanceDay');
            if (attendanceDay) {
                attendanceDay.value = now.toLocaleDateString('bn-BD', { weekday: 'long' });
            }
        }

        // লগইন ট্যাব সুইচ
        function switchLoginTab(type) {
            const studentForm = document.getElementById('studentLoginForm');
            const teacherForm = document.getElementById('teacherLoginForm');
            const parentForm = document.getElementById('parentLoginForm');
            const buttons = document.querySelectorAll('.login-tab button');
            
            buttons.forEach(btn => btn.classList.remove('active'));
            
            if (type === 'student') {
                studentForm.style.display = 'block';
                teacherForm.style.display = 'none';
                parentForm.style.display = 'none';
                buttons[0].classList.add('active');
            } else if (type === 'teacher') {
                studentForm.style.display = 'none';
                teacherForm.style.display = 'block';
                parentForm.style.display = 'none';
                buttons[1].classList.add('active');
            } else {
                studentForm.style.display = 'none';
                teacherForm.style.display = 'none';
                parentForm.style.display = 'block';
                buttons[2].classList.add('active');
            }
        }

        // ছাত্র লগইন
        function studentLogin() {
            const roll = document.getElementById('studentRoll').value;
            const name = document.getElementById('studentNameLogin').value;
            const student = students.find(s => s.roll === roll && s.name === name);
            
            if (student) {
                currentUser = { ...student, type: 'student' };
                
                document.getElementById('loginPage').style.display = 'none';
                document.getElementById('studentDashboard').style.display = 'block';
                
                document.getElementById('studentDisplayName').textContent = student.name;
                document.getElementById('studentFullName').textContent = student.name;
                document.getElementById('studentIdDisplay').textContent = `রোল: ${student.roll} | সেকশন: ${student.section}`;
                document.getElementById('studentBatchDisplay').textContent = `ব্যাচ: ${student.batch}`;
                document.getElementById('studentSectionDisplay').textContent = `সেকশন: ${student.section}`;
                document.getElementById('studentBloodGroup').textContent = `ব্লাড গ্রুপ: ${student.bloodGroup}`;
                
                updateStudentStats();
                loadStudentMessages();
                loadStudentNotices();
                
                showNotification(`স্বাগতম ${student.name}!`, 'success');
            } else {
                showNotification('ভুল রোল বা নাম', 'error');
            }
        }

        // শিক্ষক লগইন
        function teacherLogin() {
            const id = document.getElementById('teacherId').value;
            const password = document.getElementById('teacherPassword').value;
            const teacher = teachers.find(t => t.id === id && t.password === password);
            
            if (teacher) {
                currentUser = { ...teacher, type: 'teacher' };
                
                document.getElementById('loginPage').style.display = 'none';
                document.getElementById('teacherDashboard').style.display = 'block';
                document.getElementById('teacherDisplayName').textContent = teacher.name;
                
                updateTeacherStats();
                loadStudents();
                loadMessageStudentSelect();
                loadSentMessages();
                updateExamSummary();
                loadRecentExams();
                updateFineStats();
                
                showNotification(`স্বাগতম ${teacher.name}!`, 'success');
            } else {
                showNotification('ভুল আইডি বা পাসওয়ার্ড', 'error');
            }
        }

        // অভিভাবক লগইন
        function parentLogin() {
            const phone = document.getElementById('parentPhone').value;
            const password = document.getElementById('parentPassword').value;
            const parent = parents.find(p => p.phone === phone && p.password === password);
            
            if (parent) {
                currentUser = { ...parent, type: 'parent' };
                
                document.getElementById('loginPage').style.display = 'none';
                document.getElementById('parentDashboard').style.display = 'block';
                document.getElementById('parentDisplayName').textContent = parent.name;
                document.getElementById('parentWelcomeName').textContent = parent.name;
                
                loadChildren();
                loadParentMessages();
                updateParentFinancialSummary();
                
                showNotification(`স্বাগতম ${parent.name}!`, 'success');
            } else {
                showNotification('ভুল মোবাইল বা পাসওয়ার্ড', 'error');
            }
        }

        // লগআউট ফাংশন
        function studentLogout() {
            currentUser = null;
            document.getElementById('studentDashboard').style.display = 'none';
            document.getElementById('loginPage').style.display = 'flex';
            showNotification('লগআউট সফল হয়েছে', 'info');
        }

        function teacherLogout() {
            currentUser = null;
            document.getElementById('teacherDashboard').style.display = 'none';
            document.getElementById('loginPage').style.display = 'flex';
            showNotification('লগআউট সফল হয়েছে', 'info');
        }

        function parentLogout() {
            currentUser = null;
            document.getElementById('parentDashboard').style.display = 'none';
            document.getElementById('loginPage').style.display = 'flex';
            showNotification('লগআউট সফল হয়েছে', 'info');
        }

        // মডাল বন্ধ
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // মডালের বাইরে ক্লিক করলে বন্ধ
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
            }
        }

        // ছাত্রের স্ট্যাটস আপডেট
        function updateStudentStats() {
            if (!currentUser || currentUser.type !== 'student') return;
            
            const student = currentUser;
            const today = moment().format('YYYY-MM-DD');
            
            const present = student.attendance.filter(a => a.status === 'present').length;
            const absent = student.attendance.filter(a => a.status === 'absent').length;
            const late = student.attendance.filter(a => a.status === 'late').length;
            
            document.getElementById('studentPresent').textContent = present;
            document.getElementById('studentAbsent').textContent = absent;
            
            const totalFines = student.fines ? student.fines.reduce((sum, f) => sum + f.amount, 0) : 0;
            const paidFines = student.fines ? student.fines.filter(f => f.paid).reduce((sum, f) => sum + f.amount, 0) : 0;
            const pendingFines = totalFines - paidFines;
            
            document.getElementById('studentFine').textContent = `৳${pendingFines}`;
            
            const todayAttendance = student.attendance.find(a => a.date === today);
            if (todayAttendance) {
                document.getElementById('studentTodayCheckIn').textContent = todayAttendance.status === 'present' ? '✅ উপস্থিত' : todayAttendance.status === 'late' ? '⏰ দেরিতে' : '❌ অনুপস্থিত';
                document.getElementById('studentTodayStatus').textContent = todayAttendance.status === 'present' ? 'উপস্থিত' : todayAttendance.status === 'late' ? 'দেরিতে' : 'অনুপস্থিত';
            } else {
                document.getElementById('studentTodayCheckIn').textContent = '❌ করেনি';
                document.getElementById('studentTodayStatus').textContent = 'চেক-ইন করেনি';
            }
            
            const totalDays = present + absent + late;
            const rate = totalDays > 0 ? Math.round(((present + late) / totalDays) * 100) : 0;
            document.getElementById('studentAttendanceRate').textContent = rate + '%';
            document.getElementById('attendanceProgress').style.width = rate + '%';
            
            document.getElementById('totalFineAmount').textContent = `৳${totalFines}`;
            document.getElementById('paidFineAmount').textContent = `৳${paidFines}`;
            document.getElementById('pendingFineAmount').textContent = `৳${pendingFines}`;
            
            loadExamResults();
        }

        // পরীক্ষার ফলাফল লোড
        function loadExamResults() {
            if (!currentUser || currentUser.type !== 'student') return;
            
            const examContainer = document.getElementById('examResults');
            const exams = currentUser.exams || [];
            
            if (exams.length === 0) {
                examContainer.innerHTML = '<div style="text-align: center; padding: 40px; color: var(--gray-500);"><i class="fas fa-pencil-alt" style="font-size: 48px; margin-bottom: 15px;"></i><br>কোন পরীক্ষা নেই</div>';
                return;
            }
            
            examContainer.innerHTML = exams.slice(-5).reverse().map(exam => {
                const statusClass = exam.marks < settings.passingMarks ? 'status-fail' : 
                                    exam.marks === exam.totalMarks ? 'status-excellent' : 'status-pass';
                const statusText = exam.marks < settings.passingMarks ? 'ফেল' : 
                                  exam.marks === exam.totalMarks ? '১০ এ ১০' : 'পাশ';
                return `
                    <div class="message-item">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="font-weight: 700; font-size: 18px;">${exam.subject}</div>
                                <div style="font-size: 14px; color: var(--gray-500);">${moment(exam.date).format('DD MMMM YYYY')}</div>
                            </div>
                            <div style="text-align: center;">
                                <div style="font-weight: 800; font-size: 24px;">${exam.marks}/${exam.totalMarks}</div>
                                <span class="status-badge ${statusClass}">${statusText}</span>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // নোটিশ লোড
        function loadStudentNotices() {
            if (!currentUser || currentUser.type !== 'student') return;
            
            const noticeDiv = document.getElementById('studentNotices');
            const student = currentUser;
            let notices = [];

            // বকেয়া জরিমানা থাকলে নোটিশ
            const pendingFines = student.fines ? student.fines.filter(f => !f.paid) : [];
            if (pendingFines.length > 0) {
                const totalPending = pendingFines.reduce((sum, f) => sum + f.amount, 0);
                notices.push(`
                    <div class="notice-item">
                        <i class="fas fa-exclamation-triangle" style="color: #dc2626; margin-right: 15px;"></i>
                        <strong>জরুরি নোটিশ!</strong> আপনার মোট বকেয়া জরিমানা: ৳${totalPending}. দ্রুত পরিশোধ করুন।
                    </div>
                `);
            }

            // আজকের উপস্থিতি
            const today = moment().format('YYYY-MM-DD');
            const todayAttendance = student.attendance.find(a => a.date === today);
            if (!todayAttendance) {
                notices.push(`
                    <div class="notice-item" style="background: linear-gradient(135deg, #e0f2fe, #bae6fd); border-left-color: var(--primary-500);">
                        <i class="fas fa-bell" style="color: var(--primary-600); margin-right: 15px;"></i>
                        <strong>মনে করিয়ে দিচ্ছি!</strong> আজ আপনি এখনও চেক-ইন করেননি।
                    </div>
                `);
            } else if (todayAttendance.status === 'absent') {
                notices.push(`
                    <div class="notice-item" style="background: linear-gradient(135deg, #fee2e2, #fecaca); border-left-color: var(--danger);">
                        <i class="fas fa-times-circle" style="color: var(--danger); margin-right: 15px;"></i>
                        <strong>দুঃখিত!</strong> আজ আপনি অনুপস্থিত হিসেবে চিহ্নিত হয়েছেন।
                    </div>
                `);
            }

            if (notices.length === 0) {
                notices.push(`
                    <div class="notice-item" style="background: linear-gradient(135deg, #d1fae5, #a7f3d0); border-left-color: var(--success);">
                        <i class="fas fa-check-circle" style="color: var(--success); margin-right: 15px;"></i>
                        <strong>সবকিছু ঠিক আছে!</strong> আপনার কোন নোটিশ নেই।
                    </div>
                `);
            }
            
            noticeDiv.innerHTML = notices.join('');
        }

        // শিক্ষক স্ট্যাটস আপডেট
        function updateTeacherStats() {
            document.getElementById('totalStudents').textContent = students.length;
            
            const today = moment().format('YYYY-MM-DD');
            const todayPresent = students.filter(s => s.attendance.some(a => a.date === today && (a.status === 'present' || a.status === 'late'))).length;
            const todayAbsent = students.filter(s => !s.attendance.some(a => a.date === today)).length;
            
            document.getElementById('todayPresent').textContent = todayPresent;
            document.getElementById('todayAbsent').textContent = todayAbsent;
            
            let totalFines = 0;
            students.forEach(student => {
                if (student.fines) {
                    totalFines += student.fines.reduce((sum, f) => sum + f.amount, 0);
                }
            });
            document.getElementById('totalFines').textContent = `৳${totalFines}`;
            
            const attendancePercentage = students.length > 0 ? Math.round((todayPresent / students.length) * 100) : 0;
            document.getElementById('attendancePercentage').textContent = attendancePercentage + '%';
        }

        // জরিমানা স্ট্যাটস আপডেট
        function updateFineStats() {
            let collected = 0, pending = 0, count = 0;
            
            students.forEach(student => {
                if (student.fines) {
                    student.fines.forEach(fine => {
                        if (fine.paid) collected += fine.amount;
                        else pending += fine.amount;
                        count++;
                    });
                }
            });
            
            document.getElementById('totalFineCollected').textContent = `৳${collected}`;
            document.getElementById('totalFinePending').textContent = `৳${pending}`;
            document.getElementById('totalFineCount').textContent = count;
        }

        // পরীক্ষা সারাংশ আপডেট
        function updateExamSummary() {
            let excellent = 0;
            
            students.forEach(student => {
                if (student.exams && student.exams.length > 0) {
                    const lastExam = student.exams[student.exams.length - 1];
                    if (lastExam.marks === lastExam.totalMarks) excellent++;
                }
            });
            
            document.getElementById('totalExcellent').textContent = excellent;
        }

        // সাম্প্রতিক পরীক্ষা লোড
        function loadRecentExams() {
            const container = document.getElementById('recentExams');
            const allExams = [];
            
            students.forEach(student => {
                if (student.exams) {
                    student.exams.forEach(exam => {
                        allExams.push({
                            ...exam,
                            studentName: student.name,
                            studentRoll: student.roll
                        });
                    });
                }
            });
            
            const recentExams = allExams.sort((a, b) => new Date(b.date) - new Date(a.date)).slice(0, 10);
            
            if (recentExams.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 40px; color: var(--gray-500);"><i class="fas fa-pencil-alt" style="font-size: 48px; margin-bottom: 15px;"></i><br>কোন পরীক্ষা নেই</div>';
                return;
            }
            
            container.innerHTML = recentExams.map(exam => {
                const statusClass = exam.marks < settings.passingMarks ? 'status-fail' : 
                                    exam.marks === exam.totalMarks ? 'status-excellent' : 'status-pass';
                const statusText = exam.marks < settings.passingMarks ? 'ফেল' : 
                                  exam.marks === exam.totalMarks ? '১০ এ ১০' : 'পাশ';
                return `
                    <div class="message-item">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <span style="font-weight: 700;">${exam.studentName}</span> (${exam.studentRoll})
                                <div style="font-size: 14px; color: var(--gray-500);">${moment(exam.date).format('DD/MM/YYYY')}</div>
                            </div>
                            <div>
                                <span class="status-badge ${statusClass}">${exam.marks}/${exam.totalMarks} ${statusText}</span>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // ছাত্র তালিকা লোড
        function loadStudents() {
            const tbody = document.getElementById('studentsList');
            const filteredStudents = students.filter(s => s.batch === currentBatch);
            
            tbody.innerHTML = filteredStudents.map(student => {
                const today = moment().format('YYYY-MM-DD');
                const todayAttendance = student.attendance.find(a => a.date === today);
                const statusClass = todayAttendance ? 
                    (todayAttendance.status === 'present' ? 'status-present' : 
                     todayAttendance.status === 'late' ? 'status-late' : 'status-absent') : 
                    'status-absent';
                const statusText = todayAttendance ? 
                    (todayAttendance.status === 'present' ? 'উপস্থিত' : 
                     todayAttendance.status === 'late' ? 'দেরিতে' : 'অনুপস্থিত') : 
                    'অনুপস্থিত';
                
                const pendingFines = student.fines ? student.fines.filter(f => !f.paid).reduce((sum, f) => sum + f.amount, 0) : 0;
                
                const lastExam = student.exams && student.exams.length > 0 ? student.exams[student.exams.length - 1] : null;
                const examText = lastExam ? `${lastExam.marks}/${lastExam.totalMarks}` : 'নেই';
                const examClass = lastExam ? 
                    (lastExam.marks < settings.passingMarks ? 'status-fail' : 
                     lastExam.marks === lastExam.totalMarks ? 'status-excellent' : 'status-pass') : '';
                
                return `
                    <tr>
                        <td>${student.roll}</td>
                        <td>${student.name}</td>
                        <td>${student.section}</td>
                        <td>${student.phone}</td>
                        <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                        <td><span style="font-weight: 700; color: ${pendingFines > 0 ? '#dc2626' : '#10b981'};">৳${pendingFines}</span></td>
                        <td>${lastExam ? `<span class="status-badge ${examClass}">${examText}</span>` : 'নেই'}</td>
                        <td>
                            <div style="display: flex; gap: 8px;">
                                <button class="btn btn-sm btn-primary" onclick="viewStudentDetails('${student.id}')" title="বিস্তারিত">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="btn btn-sm btn-success" onclick="markPresent('${student.id}')" title="উপস্থিত">
                                    <i class="fas fa-check"></i>
                                </button>
                                <button class="btn btn-sm btn-warning" onclick="markLate('${student.id}')" title="দেরিতে">
                                    <i class="fas fa-clock"></i>
                                </button>
                                <button class="btn btn-sm btn-danger" onclick="markAbsent('${student.id}')" title="অনুপস্থিত">
                                    <i class="fas fa-times"></i>
                                </button>
                                ${pendingFines > 0 ? `
                                    <button class="btn btn-sm btn-success" onclick="showPayFineModal('${student.id}')" title="জরিমানা পরিশোধ">
                                        <i class="fas fa-money-bill"></i>
                                    </button>
                                ` : ''}
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        // ছাত্র খোঁজা
        function searchStudents() {
            const searchTerm = document.getElementById('searchStudent').value.toLowerCase();
            const rows = document.querySelectorAll('#studentsList tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        }

        // এক্সপোর্ট ছাত্র তালিকা
        function exportStudentList() {
            const filteredStudents = students.filter(s => s.batch === currentBatch);
            let csv = 'রোল,নাম,সেকশন,মোবাইল,উপস্থিতি,জরিমানা\n';
            
            filteredStudents.forEach(s => {
                const pendingFines = s.fines ? s.fines.filter(f => !f.paid).reduce((sum, f) => sum + f.amount, 0) : 0;
                csv += `${s.roll},${s.name},${s.section},${s.phone},${s.attendance.length},${pendingFines}\n`;
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `students_${currentBatch}_${moment().format('YYYY-MM-DD')}.csv`;
            a.click();
            
            showNotification('ছাত্র তালিকা ডাউনলোড করা হয়েছে', 'success');
        }

        // ব্যাচ নির্বাচন (ছাত্র)
        function selectBatch(batch) {
            currentBatch = batch;
            const buttons = document.querySelectorAll('#studentDashboard .batch-btn');
            buttons.forEach(btn => btn.classList.toggle('active', btn.textContent.includes(batch)));
            
            if (currentUser && currentUser.type === 'student') {
                currentUser.batch = batch;
                document.getElementById('studentBatchDisplay').textContent = `ব্যাচ: ${batch}`;
            }
        }

        // ব্যাচ নির্বাচন (শিক্ষক)
        function selectTeacherBatch(batch) {
            currentBatch = batch;
            const buttons = document.querySelectorAll('#teacherDashboard .batch-btn');
            buttons.forEach(btn => btn.classList.toggle('active', btn.textContent.includes(batch)));
            document.getElementById('selectedBatch').textContent = batch + ' ব্যাচ';
            loadStudents();
        }

        // ছাত্র চেক-ইন
        function studentCheckIn() {
            if (!currentUser || currentUser.type !== 'student') return;
            
            const today = moment().format('YYYY-MM-DD');
            if (currentUser.attendance.some(a => a.date === today)) {
                showNotification('আজ ইতিমধ্যে চেক-ইন করেছেন', 'warning');
                return;
            }
            
            const now = moment();
            const classStartTime = moment('09:00', 'HH:mm');
            let status = now.isAfter(classStartTime) ? 'late' : 'present';
            
            currentUser.attendance.push({ date: today, status: status });
            
            const studentIndex = students.findIndex(s => s.id === currentUser.id);
            if (studentIndex !== -1) {
                students[studentIndex].attendance = currentUser.attendance;
            }
            
            updateStudentStats();
            loadStudentNotices();
            showNotification('চেক-ইন সফল হয়েছে! ' + (status === 'late' ? 'দেরিতে এসেছেন।' : 'সময়ে এসেছেন।'), status === 'late' ? 'warning' : 'success');
        }

        // মার্ক প্রেজেন্ট
        function markPresent(studentId) {
            const student = students.find(s => s.id === studentId);
            if (!student) return;
            
            const today = moment().format('YYYY-MM-DD');
            student.attendance = student.attendance.filter(a => a.date !== today);
            student.attendance.push({ date: today, status: 'present' });
            
            loadStudents();
            updateTeacherStats();
            showNotification(`${student.name} কে উপস্থিত করা হয়েছে`, 'success');
        }

        // মার্ক লেট
        function markLate(studentId) {
            const student = students.find(s => s.id === studentId);
            if (!student) return;
            
            const today = moment().format('YYYY-MM-DD');
            student.attendance = student.attendance.filter(a => a.date !== today);
            student.attendance.push({ date: today, status: 'late' });
            
            loadStudents();
            updateTeacherStats();
            showNotification(`${student.name} কে দেরিতে হিসেবে চিহ্নিত করা হয়েছে`, 'warning');
        }

        // মার্ক অ্যাবসেন্ট
        function markAbsent(studentId) {
            const student = students.find(s => s.id === studentId);
            if (!student) return;
            
            const today = moment().format('YYYY-MM-DD');
            const dayName = moment(today).format('dddd');
            
            student.attendance = student.attendance.filter(a => a.date !== today);
            student.attendance.push({ date: today, status: 'absent' });
            
            if (!student.fines) student.fines = [];
            const existingFine = student.fines.find(f => f.date === today && f.reason.includes('অনুপস্থিতি'));
            if (!existingFine) {
                let fineAmount = dayName === 'শুক্রবার' ? settings.fineFridayAbsent : settings.finePerAbsent;
                student.fines.push({
                    date: today,
                    amount: fineAmount,
                    reason: `অনুপস্থিতি (${dayName})`,
                    paid: false
                });
            }
            
            loadStudents();
            updateTeacherStats();
            updateFineStats();
            showNotification(`${student.name} কে অনুপস্থিত করা হয়েছে এবং ৳${fineAmount} জরিমানা যোগ করা হয়েছে`, 'error');
        }

        // কুইক অ্যাটেনডেন্স
        function quickAttendance(status) {
            const today = moment().format('YYYY-MM-DD');
            const dayName = moment(today).format('dddd');
            const batchStudents = students.filter(s => s.batch === currentBatch);
            
            batchStudents.forEach(student => {
                student.attendance = student.attendance.filter(a => a.date !== today);
                student.attendance.push({ date: today, status: status });
                
                if (status === 'absent') {
                    if (!student.fines) student.fines = [];
                    const existingFine = student.fines.find(f => f.date === today && f.reason.includes('অনুপস্থিতি'));
                    if (!existingFine) {
                        let fineAmount = dayName === 'শুক্রবার' ? settings.fineFridayAbsent : settings.finePerAbsent;
                        student.fines.push({
                            date: today,
                            amount: fineAmount,
                            reason: `অনুপস্থিতি (${dayName})`,
                            paid: false
                        });
                    }
                }
            });
            
            loadStudents();
            updateTeacherStats();
            updateFineStats();
            showNotification(`সবাইকে ${status === 'present' ? 'উপস্থিত' : status === 'late' ? 'দেরিতে' : 'অনুপস্থিত'} করা হয়েছে`, 'success');
        }

        // উপস্থিতি নেওয়া শুরু
        function takeAttendance() {
            document.getElementById('attendanceBatch').textContent = currentBatch + ' ব্যাচ';
            document.getElementById('attendanceDate').value = moment().format('YYYY-MM-DD');
            document.getElementById('attendanceDay').value = moment().format('dddd');
            
            const batchStudents = students.filter(s => s.batch === currentBatch);
            const tbody = document.getElementById('attendanceList');
            
            tbody.innerHTML = batchStudents.map(student => {
                const today = moment().format('YYYY-MM-DD');
                const todayAttendance = student.attendance.find(a => a.date === today);
                return `
                    <tr>
                        <td>${student.name}</td>
                        <td>${student.roll}</td>
                        <td>
                            <select class="form-control" id="attendance-${student.id}" style="width: 150px;">
                                <option value="present" ${todayAttendance?.status === 'present' ? 'selected' : ''}>উপস্থিত</option>
                                <option value="late" ${todayAttendance?.status === 'late' ? 'selected' : ''}>দেরিতে</option>
                                <option value="absent" ${!todayAttendance || todayAttendance?.status === 'absent' ? 'selected' : ''}>অনুপস্থিত</option>
                            </select>
                        </td>
                    </tr>
                `;
            }).join('');
            
            document.getElementById('attendanceModal').style.display = 'flex';
        }

        // সবাই উপস্থিত
        function markAllPresent() {
            document.querySelectorAll('[id^="attendance-"]').forEach(select => select.value = 'present');
        }

        // সবাই দেরিতে
        function markAllLate() {
            document.querySelectorAll('[id^="attendance-"]').forEach(select => select.value = 'late');
        }

        // সবাই অনুপস্থিত
        function markAllAbsent() {
            document.querySelectorAll('[id^="attendance-"]').forEach(select => select.value = 'absent');
        }

        // উপস্থিতি সংরক্ষণ
        function saveAttendance() {
            const date = document.getElementById('attendanceDate').value;
            const dayName = moment(date).format('dddd');
            const batchStudents = students.filter(s => s.batch === currentBatch);
            
            batchStudents.forEach(student => {
                const status = document.getElementById(`attendance-${student.id}`).value;
                student.attendance = student.attendance.filter(a => a.date !== date);
                student.attendance.push({ date: date, status: status });
                
                if (status === 'absent') {
                    if (!student.fines) student.fines = [];
                    const existingFine = student.fines.find(f => f.date === date && f.reason.includes('অনুপস্থিতি'));
                    if (!existingFine) {
                        let fineAmount = dayName === 'শুক্রবার' ? settings.fineFridayAbsent : settings.finePerAbsent;
                        student.fines.push({
                            date: date,
                            amount: fineAmount,
                            reason: `অনুপস্থিতি (${dayName})`,
                            paid: false
                        });
                    }
                }
            });
            
            closeModal('attendanceModal');
            updateTeacherStats();
            loadStudents();
            updateFineStats();
            showNotification('উপস্থিতি সংরক্ষণ করা হয়েছে', 'success');
        }

        // ছাত্রের বিস্তারিত দেখুন
        function viewStudentDetails(studentId) {
            const student = students.find(s => s.id === studentId);
            if (!student) return;
            
            const totalFines = student.fines ? student.fines.reduce((sum, f) => sum + f.amount, 0) : 0;
            const paidFines = student.fines ? student.fines.filter(f => f.paid).reduce((sum, f) => sum + f.amount, 0) : 0;
            const pendingFines = totalFines - paidFines;
            
            const present = student.attendance.filter(a => a.status === 'present').length;
            const absent = student.attendance.filter(a => a.status === 'absent').length;
            const late = student.attendance.filter(a => a.status === 'late').length;
            
            const lastExam = student.exams && student.exams.length > 0 ? student.exams[student.exams.length - 1] : null;
            
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'flex';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 600px;">
                    <div class="modal-header">
                        <h3><i class="fas fa-user"></i> ${student.name} - বিস্তারিত তথ্য</h3>
                        <button class="close-modal" onclick="this.closest('.modal').remove()">&times;</button>
                    </div>
                    <div style="padding: 20px;">
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-bottom: 30px;">
                            <div style="background: #f8fafc; padding: 20px; border-radius: 20px;">
                                <div style="color: var(--gray-500);">রোল</div>
                                <div style="font-weight: 700; font-size: 24px;">${student.roll}</div>
                            </div>
                            <div style="background: #f8fafc; padding: 20px; border-radius: 20px;">
                                <div style="color: var(--gray-500);">সেকশন</div>
                                <div style="font-weight: 700; font-size: 24px;">${student.section}</div>
                            </div>
                            <div style="background: #f8fafc; padding: 20px; border-radius: 20px;">
                                <div style="color: var(--gray-500);">ব্যাচ</div>
                                <div style="font-weight: 700; font-size: 24px;">${student.batch}</div>
                            </div>
                            <div style="background: #f8fafc; padding: 20px; border-radius: 20px;">
                                <div style="color: var(--gray-500);">মোবাইল</div>
                                <div style="font-weight: 700; font-size: 24px;">${student.phone}</div>
                            </div>
                        </div>
                        
                        <h4 style="margin-bottom: 15px;">উপস্থিতির পরিসংখ্যান</h4>
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 30px;">
                            <div style="text-align: center; padding: 20px; background: linear-gradient(135deg, #d1fae5, #a7f3d0); border-radius: 20px;">
                                <div style="font-weight: 800; font-size: 32px;">${present}</div>
                                <div>উপস্থিত</div>
                            </div>
                            <div style="text-align: center; padding: 20px; background: linear-gradient(135deg, #fed7aa, #fde68a); border-radius: 20px;">
                                <div style="font-weight: 800; font-size: 32px;">${late}</div>
                                <div>দেরিতে</div>
                            </div>
                            <div style="text-align: center; padding: 20px; background: linear-gradient(135deg, #fee2e2, #fecaca); border-radius: 20px;">
                                <div style="font-weight: 800; font-size: 32px;">${absent}</div>
                                <div>অনুপস্থিত</div>
                            </div>
                        </div>
                        
                        <h4 style="margin-bottom: 15px;">আর্থিক তথ্য</h4>
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 30px;">
                            <div style="text-align: center; padding: 20px; background: #f8fafc; border-radius: 20px;">
                                <div style="font-weight: 800; font-size: 24px;">৳${totalFines}</div>
                                <div>মোট জরিমানা</div>
                            </div>
                            <div style="text-align: center; padding: 20px; background: #d1fae5; border-radius: 20px;">
                                <div style="font-weight: 800; font-size: 24px;">৳${paidFines}</div>
                                <div>পরিশোধিত</div>
                            </div>
                            <div style="text-align: center; padding: 20px; background: #fee2e2; border-radius: 20px;">
                                <div style="font-weight: 800; font-size: 24px;">৳${pendingFines}</div>
                                <div>বকেয়া</div>
                            </div>
                        </div>
                        
                        ${lastExam ? `
                            <h4 style="margin-bottom: 15px;">সর্বশেষ পরীক্ষা</h4>
                            <div style="background: #f8fafc; padding: 20px; border-radius: 20px;">
                                <div style="display: flex; justify-content: space-between;">
                                    <div>
                                        <div style="font-weight: 700;">${lastExam.subject}</div>
                                        <div style="color: var(--gray-500);">${moment(lastExam.date).format('DD MMMM YYYY')}</div>
                                    </div>
                                    <div>
                                        <span class="status-badge ${lastExam.marks < settings.passingMarks ? 'status-fail' : lastExam.marks === lastExam.totalMarks ? 'status-excellent' : 'status-pass'}">
                                            ${lastExam.marks}/${lastExam.totalMarks}
                                        </span>
                                    </div>
                                </div>
                            </div>
                        ` : ''}
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // জরিমানা পরিশোধ মডাল দেখান
        function showPayFineModal(studentId) {
            const student = students.find(s => s.id === studentId);
            if (!student) return;
            
            const pendingFines = student.fines ? student.fines.filter(f => !f.paid) : [];
            const totalPending = pendingFines.reduce((sum, f) => sum + f.amount, 0);
            
            document.getElementById('fineStudentName').value = student.name;
            document.getElementById('fineAmount').value = `৳${totalPending}`;
            document.getElementById('paymentDate').value = moment().format('DD/MM/YYYY');
            
            const fineDetails = document.getElementById('fineDetails');
            fineDetails.innerHTML = pendingFines.map(f => `
                <div style="display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid var(--gray-200);">
                    <span>${f.reason} (${moment(f.date).format('DD/MM/YYYY')})</span>
                    <span style="font-weight: 700; color: #dc2626;">৳${f.amount}</span>
                </div>
            `).join('');
            
            document.getElementById('payFineModal').setAttribute('data-student-id', studentId);
            document.getElementById('payFineModal').style.display = 'flex';
        }

        // জরিমানা পরিশোধ
        function payFine() {
            const studentId = document.getElementById('payFineModal').getAttribute('data-student-id');
            const student = students.find(s => s.id === studentId);
            
            if (student && student.fines) {
                student.fines.forEach(fine => { 
                    if (!fine.paid) {
                        fine.paid = true;
                        fine.paymentMethod = document.getElementById('paymentMethod').value;
                        fine.transactionId = document.getElementById('transactionId').value;
                        fine.paymentDate = moment().format('YYYY-MM-DD');
                    }
                });
            }
            
            closeModal('payFineModal');
            loadStudents();
            updateTeacherStats();
            updateFineStats();
            showNotification('জরিমানা পরিশোধ সফল হয়েছে', 'success');
        }

        // আংশিক জরিমানা পরিশোধ
        function payPartialFine() {
            const amount = prompt('কত টাকা পরিশোধ করতে চান?');
            if (!amount) return;
            
            const studentId = document.getElementById('payFineModal').getAttribute('data-student-id');
            const student = students.find(s => s.id === studentId);
            
            if (student && student.fines) {
                let remaining = parseInt(amount);
                for (let fine of student.fines) {
                    if (!fine.paid && remaining > 0) {
                        if (fine.amount <= remaining) {
                            fine.paid = true;
                            remaining -= fine.amount;
                        } else {
                            showNotification('আংশিক পরিশোধের জন্য সম্পূর্ণ পরিশোধ করুন', 'warning');
                            return;
                        }
                    }
                }
            }
            
            closeModal('payFineModal');
            loadStudents();
            updateTeacherStats();
            updateFineStats();
            showNotification('আংশিক জরিমানা পরিশোধ সফল হয়েছে', 'success');
        }

        // পরীক্ষার নম্বর দেওয়ার মডাল দেখান
        function showExamMarksModal() {
            document.getElementById('examMarksModal').style.display = 'flex';
            
            const tbody = document.getElementById('examMarksList');
            const batchStudents = students.filter(s => s.batch === currentBatch);
            
            tbody.innerHTML = batchStudents.map(student => {
                const lastExam = student.exams && student.exams.length > 0 ? student.exams[student.exams.length-1] : null;
                return `
                    <tr>
                        <td>${student.name}</td>
                        <td>${student.roll}</td>
                        <td>
                            <input type="number" class="form-control" id="marks-${student.id}" 
                                min="0" max="10" value="${lastExam ? lastExam.marks : 0}" style="width: 80px;">
                        </td>
                        <td>
                            <input type="checkbox" id="absent-${student.id}" onchange="toggleAbsent('${student.id}')">
                        </td>
                    </tr>
                `;
            }).join('');
        }

        // অনুপস্থিত টগল
        function toggleAbsent(studentId) {
            const marksInput = document.getElementById(`marks-${studentId}`);
            const absentCheck = document.getElementById(`absent-${studentId}`);
            
            if (absentCheck.checked) {
                marksInput.value = 0;
                marksInput.disabled = true;
            } else {
                marksInput.disabled = false;
            }
        }

        // সবাই পাস
        function markAllPass() {
            document.querySelectorAll('[id^="marks-"]').forEach(input => {
                if (!input.disabled) input.value = 8;
            });
        }

        // সবাই গড়
        function markAllAverage() {
            document.querySelectorAll('[id^="marks-"]').forEach(input => {
                if (!input.disabled) input.value = 7;
            });
        }

        // সবাই অনুপস্থিত
        function markAllAbsentExam() {
            document.querySelectorAll('[id^="marks-"]').forEach(input => {
                input.value = 0;
                input.disabled = true;
            });
            document.querySelectorAll('[id^="absent-"]').forEach(checkbox => {
                checkbox.checked = true;
            });
        }

        // পরীক্ষার নম্বর সংরক্ষণ
        function saveExamMarks() {
            const examName = document.getElementById('examName').value;
            const examDate = document.getElementById('examDate').value;
            const totalMarks = parseInt(document.getElementById('examTotalMarks').value) || 10;
            
            const batchStudents = students.filter(s => s.batch === currentBatch);
            
            batchStudents.forEach(student => {
                const marksInput = document.getElementById(`marks-${student.id}`);
                const absentCheck = document.getElementById(`absent-${student.id}`);
                
                if (!marksInput) return;
                
                const marks = absentCheck && absentCheck.checked ? 0 : parseInt(marksInput.value) || 0;
                
                if (!student.exams) student.exams = [];
                
                student.exams.push({
                    date: examDate,
                    subject: examName,
                    marks: marks,
                    totalMarks: totalMarks
                });
                
                if (!student.fines) student.fines = [];
                
                if (marks === 0) {
                    const absentFineExists = student.fines.find(f => f.date === examDate && f.reason.includes('পরীক্ষায় অনুপস্থিত'));
                    if (!absentFineExists) {
                        student.fines.push({
                            date: examDate,
                            amount: settings.finePerExamAbsent,
                            reason: 'পরীক্ষায় অনুপস্থিত',
                            paid: false
                        });
                    }
                } else if (marks < settings.passingMarks) {
                    const failFineExists = student.fines.find(f => f.date === examDate && f.reason.includes('ফেল'));
                    if (!failFineExists) {
                        student.fines.push({
                            date: examDate,
                            amount: settings.finePerExamFail,
                            reason: 'পরীক্ষায় ফেল',
                            paid: false
                        });
                    }
                }
            });
            
            closeModal('examMarksModal');
            updateExamSummary();
            loadStudents();
            loadRecentExams();
            updateFineStats();
            showNotification('পরীক্ষার নম্বর সংরক্ষণ করা হয়েছে', 'success');
        }

        // নতুন ছাত্র যোগের মডাল দেখান
        function showAddStudentModal() {
            document.getElementById('addStudentModal').style.display = 'flex';
        }

        // ছাত্র সংরক্ষণ
        function saveStudent(event) {
            event.preventDefault();
            
            const newStudent = {
                id: `STU${String(students.length + 1).padStart(3, '0')}`,
                roll: document.getElementById('studentRoll').value,
                name: document.getElementById('studentName').value,
                phone: document.getElementById('studentPhone').value,
                whatsapp: document.getElementById('studentWhatsapp').value || document.getElementById('studentPhone').value,
                email: document.getElementById('studentEmail').value,
                bloodGroup: document.getElementById('studentBloodGroup').value,
                sscGpa: document.getElementById('studentSscGpa').value,
                batch: document.getElementById('studentBatch').value,
                section: document.getElementById('studentSection').value,
                parentName: document.getElementById('parentName').value,
                parentPhone: document.getElementById('parentPhone').value,
                motherName: document.getElementById('motherName').value,
                motherPhone: document.getElementById('motherPhone').value,
                address: document.getElementById('studentAddress').value,
                attendance: [],
                fines: [],
                payments: [],
                exams: [],
                password: '123456'
            };
            
            students.push(newStudent);
            
            if (newStudent.parentName && newStudent.parentPhone) {
                const existingParent = parents.find(p => p.phone === newStudent.parentPhone);
                if (existingParent) {
                    existingParent.children.push(newStudent.id);
                } else {
                    parents.push({
                        id: `PAR${String(parents.length + 1).padStart(3, '0')}`,
                        name: newStudent.parentName,
                        phone: newStudent.parentPhone,
                        children: [newStudent.id],
                        password: 'parent123'
                    });
                }
            }
            
            closeModal('addStudentModal');
            loadStudents();
            updateTeacherStats();
            loadMessageStudentSelect();
            document.getElementById('addStudentForm').reset();
            showNotification('নতুন ছাত্র সফলভাবে যোগ করা হয়েছে', 'success');
        }

        // বার্তার জন্য ছাত্র নির্বাচন লোড
        function loadMessageStudentSelect() {
            const select = document.getElementById('messageStudentSelect');
            select.innerHTML = '<option value="">ছাত্র নির্বাচন করুন</option>' + 
                students.map(s => `<option value="${s.id}">${s.name} (${s.roll}) - ${s.batch}</option>`).join('');
        }

        // বার্তার টেমপ্লেট আপডেট
        function updateMessageTemplate() {
            const type = document.getElementById('messageType').value;
            const studentId = document.getElementById('messageStudentSelect').value;
            const student = students.find(s => s.id === studentId);
            
            if (!student) {
                showNotification('প্রথমে ছাত্র নির্বাচন করুন', 'warning');
                return;
            }
            
            const today = moment().format('YYYY-MM-DD');
            const todayAttendance = student.attendance.find(a => a.date === today);
            const pendingFines = student.fines ? student.fines.filter(f => !f.paid).reduce((sum, f) => sum + f.amount, 0) : 0;
            const lastExam = student.exams && student.exams.length > 0 ? student.exams[student.exams.length - 1] : null;
            
            let message = '';
            
            switch(type) {
                case 'attendance':
                    if (todayAttendance) {
                        message = `আজ ${student.name} ${todayAttendance.status === 'present' ? 'উপস্থিত' : todayAttendance.status === 'late' ? 'দেরিতে' : 'অনুপস্থিত'} হয়েছে।`;
                    } else {
                        message = `আজ ${student.name} এখনও উপস্থিত হয়নি।`;
                    }
                    break;
                case 'exam':
                    if (lastExam) {
                        message = `${student.name} এর সর্বশেষ পরীক্ষায় ফলাফল: ${lastExam.marks}/${lastExam.totalMarks}।`;
                        if (lastExam.marks < settings.passingMarks) {
                            message += ` ফেল করেছে। জরিমানা ৳${settings.finePerExamFail} যোগ করা হয়েছে।`;
                        }
                    } else {
                        message = `${student.name} এর কোন পরীক্ষা এখনও হয়নি।`;
                    }
                    break;
                case 'fine':
                    message = `${student.name} এর বকেয়া জরিমানা: ৳${pendingFines}। দ্রুত পরিশোধের অনুরোধ রইল।`;
                    break;
                default:
                    message = `${student.name} এর অভিভাবককে জানানো যাচ্ছে যে...`;
            }
            
            document.getElementById('teacherMessage').value = message;
        }

        // অভিভাবককে বার্তা পাঠান
        function sendMessageToParent() {
            const studentId = document.getElementById('messageStudentSelect').value;
            const message = document.getElementById('teacherMessage').value;
            
            if (!studentId || !message) {
                showNotification('ছাত্র এবং বার্তা নির্বাচন করুন', 'warning');
                return;
            }
            
            const student = students.find(s => s.id === studentId);
            if (!student || !student.parentPhone) {
                showNotification('ছাত্রের অভিভাবক তথ্য নেই', 'error');
                return;
            }
            
            const parent = parents.find(p => p.phone === student.parentPhone);
            if (!parent) {
                showNotification('অভিভাবক খুঁজে পাওয়া যায়নি', 'error');
                return;
            }
            
            messages.push({
                id: `MSG${messages.length + 1}`,
                from: 'teacher',
                to: parent.id,
                studentId: studentId,
                studentName: student.name,
                parentName: parent.name,
                message: message,
                date: moment().format('YYYY-MM-DD HH:mm'),
                read: false
            });
            
            document.getElementById('teacherMessage').value = '';
            loadSentMessages();
            showNotification('বার্তা সফলভাবে পাঠানো হয়েছে', 'success');
        }

        // পাঠানো বার্তা লোড
        function loadSentMessages() {
            const container = document.getElementById('sentMessages');
            const teacherMessages = messages.filter(m => m.from === 'teacher').slice(-10).reverse();
            
            if (teacherMessages.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 40px; color: var(--gray-500);"><i class="fas fa-envelope" style="font-size: 48px; margin-bottom: 15px;"></i><br>কোন বার্তা নেই</div>';
                return;
            }
            
            container.innerHTML = teacherMessages.map(msg => `
                <div class="message-item teacher">
                    <div class="message-header">
                        <span class="message-sender"><i class="fas fa-user"></i> ${msg.studentName} (${msg.parentName})</span>
                        <span><i class="far fa-clock"></i> ${moment(msg.date).format('DD/MM/YYYY HH:mm')}</span>
                    </div>
                    <div class="message-content">${msg.message}</div>
                </div>
            `).join('');
        }

        // ছাত্রের বার্তা লোড
        function loadStudentMessages() {
            if (!currentUser || currentUser.type !== 'student') return;
            
            const container = document.getElementById('studentMessages');
            const student = currentUser;
            const parent = parents.find(p => p.children && p.children.includes(student.id));
            
            if (!parent) {
                container.innerHTML = '<div style="text-align: center; padding: 40px; color: var(--gray-500);"><i class="fas fa-envelope" style="font-size: 48px; margin-bottom: 15px;"></i><br>কোন বার্তা নেই</div>';
                return;
            }
            
            const studentMessages = messages.filter(m => m.to === parent.id).slice(-10).reverse();
            
            if (studentMessages.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 40px; color: var(--gray-500);"><i class="fas fa-envelope" style="font-size: 48px; margin-bottom: 15px;"></i><br>কোন বার্তা নেই</div>';
                return;
            }
            
            container.innerHTML = studentMessages.map(msg => `
                <div class="message-item teacher">
                    <div class="message-header">
                        <span class="message-sender"><i class="fas fa-chalkboard-teacher"></i> শিক্ষক</span>
                        <span><i class="far fa-clock"></i> ${moment(msg.date).format('DD/MM/YYYY HH:mm')}</span>
                    </div>
                    <div class="message-content">${msg.message}</div>
                </div>
            `).join('');
        }

        // অভিভাবকের বার্তা লোড
        function loadParentMessages() {
            if (!currentUser || currentUser.type !== 'parent') return;
            
            const container = document.getElementById('parentMessages');
            const parentMessages = messages.filter(m => m.to === currentUser.id).slice(-10).reverse();
            
            if (parentMessages.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 40px; color: var(--gray-500);"><i class="fas fa-envelope" style="font-size: 48px; margin-bottom: 15px;"></i><br>কোন বার্তা নেই</div>';
                return;
            }
            
            container.innerHTML = parentMessages.map(msg => {
                const student = students.find(s => s.id === msg.studentId);
                return `
                    <div class="message-item teacher">
                        <div class="message-header">
                            <span class="message-sender"><i class="fas fa-chalkboard-teacher"></i> শিক্ষক (${student ? student.name : ''})</span>
                            <span><i class="far fa-clock"></i> ${moment(msg.date).format('DD/MM/YYYY HH:mm')}</span>
                        </div>
                        <div class="message-content">${msg.message}</div>
                    </div>
                `;
            }).join('');
        }

        // সন্তানের তালিকা লোড
        function loadChildren() {
            if (!currentUser || currentUser.type !== 'parent') return;
            
            const childrenList = document.getElementById('childrenList');
            const parentChildren = students.filter(s => currentUser.children.includes(s.id));
            
            childrenList.innerHTML = parentChildren.map(child => {
                const today = moment().format('YYYY-MM-DD');
                const todayAttendance = child.attendance.find(a => a.date === today);
                
                const pendingFines = child.fines ? child.fines.filter(f => !f.paid).reduce((sum, f) => sum + f.amount, 0) : 0;
                
                return `
                    <div class="child-card">
                        <div class="child-avatar">
                            ${child.name.charAt(0)}
                        </div>
                        <div class="child-info">
                            <h4>${child.name}</h4>
                            <p><i class="fas fa-hashtag"></i> রোল: ${child.roll} | <i class="fas fa-layer-group"></i> সেকশন: ${child.section} | <i class="fas fa-clock"></i> ব্যাচ: ${child.batch}</p>
                            <p><i class="fas fa-calendar-check"></i> আজকে: ${todayAttendance ? (todayAttendance.status === 'present' ? '✅ উপস্থিত' : todayAttendance.status === 'late' ? '⏰ দেরিতে' : '❌ অনুপস্থিত') : '❌ চেক-ইন করেনি'}</p>
                            <p><i class="fas fa-coins"></i> বকেয়া জরিমানা: <span style="color: #dc2626; font-weight: 700;">৳${pendingFines}</span></p>
                        </div>
                        <div>
                            <button class="btn btn-primary" onclick="viewChildDetails('${child.id}')">
                                <i class="fas fa-eye"></i> বিস্তারিত
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // সন্তানের বিস্তারিত দেখুন
        function viewChildDetails(childId) {
            const child = students.find(s => s.id === childId);
            if (!child) return;
            
            const present = child.attendance.filter(a => a.status === 'present').length;
            const absent = child.attendance.filter(a => a.status === 'absent').length;
            const late = child.attendance.filter(a => a.status === 'late').length;
            
            const totalFines = child.fines ? child.fines.reduce((sum, f) => sum + f.amount, 0) : 0;
            const paidFines = child.fines ? child.fines.filter(f => f.paid).reduce((sum, f) => sum + f.amount, 0) : 0;
            const pendingFines = totalFines - paidFines;
            
            let examResults = child.exams && child.exams.length > 0 ? 
                child.exams.slice(-3).map(e => `${e.subject}: ${e.marks}/${e.totalMarks} (${moment(e.date).format('DD/MM/YYYY')})`).join('<br>') : 
                'কোন পরীক্ষা নেই';
            
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'flex';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 500px;">
                    <div class="modal-header">
                        <h3><i class="fas fa-child"></i> ${child.name} - বিস্তারিত</h3>
                        <button class="close-modal" onclick="this.closest('.modal').remove()">&times;</button>
                    </div>
                    <div style="padding: 20px;">
                        <div style="background: linear-gradient(135deg, var(--primary-500), var(--secondary-500)); padding: 20px; border-radius: 30px; color: white; margin-bottom: 20px;">
                            <div style="display: flex; align-items: center; gap: 20px;">
                                <div style="width: 60px; height: 60px; background: white; border-radius: 20px; display: flex; align-items: center; justify-content: center; color: var(--primary-600); font-size: 30px; font-weight: 800;">
                                    ${child.name.charAt(0)}
                                </div>
                                <div>
                                    <div style="font-size: 24px; font-weight: 700;">${child.name}</div>
                                    <div>রোল: ${child.roll} | সেকশন: ${child.section}</div>
                                </div>
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 20px;">
                            <div style="text-align: center; padding: 15px; background: #d1fae5; border-radius: 20px;">
                                <div style="font-weight: 800; font-size: 24px;">${present}</div>
                                <div>উপস্থিত</div>
                            </div>
                            <div style="text-align: center; padding: 15px; background: #fed7aa; border-radius: 20px;">
                                <div style="font-weight: 800; font-size: 24px;">${late}</div>
                                <div>দেরিতে</div>
                            </div>
                            <div style="text-align: center; padding: 15px; background: #fee2e2; border-radius: 20px;">
                                <div style="font-weight: 800; font-size: 24px;">${absent}</div>
                                <div>অনুপস্থিত</div>
                            </div>
                        </div>
                        
                        <div style="background: #f8fafc; padding: 20px; border-radius: 20px; margin-bottom: 20px;">
                            <h4 style="margin-bottom: 15px;">আর্থিক তথ্য</h4>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                <span>মোট জরিমানা:</span>
                                <span style="font-weight: 700;">৳${totalFines}</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                <span>পরিশোধিত:</span>
                                <span style="font-weight: 700; color: #10b981;">৳${paidFines}</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span>বকেয়া:</span>
                                <span style="font-weight: 700; color: #dc2626;">৳${pendingFines}</span>
                            </div>
                        </div>
                        
                        <div style="background: #f8fafc; padding: 20px; border-radius: 20px;">
                            <h4 style="margin-bottom: 15px;">সর্বশেষ পরীক্ষা</h4>
                            <div>${examResults}</div>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // অভিভাবকের আর্থিক সারাংশ আপডেট
        function updateParentFinancialSummary() {
            if (!currentUser || currentUser.type !== 'parent') return;
            
            const parentChildren = students.filter(s => currentUser.children.includes(s.id));
            let totalFines = 0, paidFines = 0, pendingFines = 0;
            
            parentChildren.forEach(child => {
                if (child.fines) {
                    child.fines.forEach(fine => {
                        totalFines += fine.amount;
                        if (fine.paid) paidFines += fine.amount;
                        else pendingFines += fine.amount;
                    });
                }
            });
            
            const container = document.getElementById('parentFinancialSummary');
            container.innerHTML = `
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, var(--danger), #dc2626);">
                        <i class="fas fa-exclamation-circle"></i>
                    </div>
                    <div class="stat-info">
                        <h3>৳${totalFines}</h3>
                        <p>মোট জরিমানা</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, var(--success), #059669);">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="stat-info">
                        <h3>৳${paidFines}</h3>
                        <p>পরিশোধিত</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, var(--warning), #d97706);">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="stat-info">
                        <h3>৳${pendingFines}</h3>
                        <p>বকেয়া</p>
                    </div>
                </div>
            `;
        }

        // ক্যালেন্ডার দেখান (ছাত্র)
        function showStudentCalendar() {
            if (!currentUser || currentUser.type !== 'student') return;
            
            document.getElementById('calendarTitle').textContent = `${currentUser.name} - উপস্থিতির ক্যালেন্ডার`;
            updateCalendar();
            document.getElementById('calendarModal').style.display = 'flex';
        }

        // ক্যালেন্ডার আপডেট
        function updateCalendar() {
            const month = parseInt(document.getElementById('calendarMonth').value);
            const year = parseInt(document.getElementById('calendarYear').value);
            
            const firstDay = moment([year, month]).startOf('month');
            const lastDay = moment([year, month]).endOf('month');
            
            const daysInMonth = lastDay.date();
            const startDayOfWeek = firstDay.day(); // 0 = রবিবার, 1 = সোমবার
            
            let calendarHtml = '';
            
            const dayNames = ['রবি', 'সোম', 'মঙ্গল', 'বুধ', 'বৃহঃ', 'শুক্র', 'শনি'];
            dayNames.forEach(day => {
                calendarHtml += `<div style="text-align: center; font-weight: 700; padding: 15px;">${day}</div>`;
            });
            
            for (let i = 0; i < startDayOfWeek; i++) {
                calendarHtml += '<div class="calendar-day"></div>';
            }
            
            for (let date = 1; date <= daysInMonth; date++) {
                const dateStr = moment([year, month, date]).format('YYYY-MM-DD');
                const attendance = currentUser.attendance.find(a => a.date === dateStr);
                
                let statusClass = '';
                if (attendance) {
                    statusClass = attendance.status === 'present' ? 'present' : 
                                 attendance.status === 'late' ? 'late' : 'absent';
                }
                
                calendarHtml += `
                    <div class="calendar-day ${statusClass}">
                        ${date}
                    </div>
                `;
            }
            
            document.getElementById('calendarGrid').innerHTML = calendarHtml;
        }

        // জরিমানা সেটিংস দেখান
        function showFineSettings() {
            document.getElementById('finePerAbsent').value = settings.finePerAbsent;
            document.getElementById('fineFridayAbsent').value = settings.fineFridayAbsent;
            document.getElementById('finePerExamAbsent').value = settings.finePerExamAbsent;
            document.getElementById('finePerExamFail').value = settings.finePerExamFail;
            document.getElementById('monthlyFee').value = settings.monthlyFee;
            
            document.getElementById('fineSettingsModal').style.display = 'flex';
        }

        // জরিমানা সেটিংস সংরক্ষণ
        function saveFineSettings() {
            settings.finePerAbsent = parseInt(document.getElementById('finePerAbsent').value) || 50;
            settings.fineFridayAbsent = parseInt(document.getElementById('fineFridayAbsent').value) || 100;
            settings.finePerExamAbsent = parseInt(document.getElementById('finePerExamAbsent').value) || 200;
            settings.finePerExamFail = parseInt(document.getElementById('finePerExamFail').value) || 100;
            settings.monthlyFee = parseInt(document.getElementById('monthlyFee').value) || 1500;
            
            closeModal('fineSettingsModal');
            showNotification('জরিমানা সেটিংস সংরক্ষণ করা হয়েছে', 'success');
        }

        // সকল পরীক্ষা দেখুন
        function viewAllExams() {
            if (!currentUser) return;
            
            const examList = currentUser.exams.map(e => 
                `${e.subject}: ${e.marks}/${e.totalMarks} (${moment(e.date).format('DD/MM/YYYY')})`
            ).join('\n');
            
            showNotification(examList || 'কোন পরীক্ষা নেই', 'info');
        }

        // নোটিস রিফ্রেশ
        function refreshNotices() {
            loadStudentNotices();
            showNotification('নোটিশ বোর্ড রিফ্রেশ করা হয়েছে', 'success');
        }

        // ট্যাব ফাংশন
        function showStudentTab(tab, event) {
            if (event) {
                document.querySelectorAll('#studentDashboard .bottom-menu-item').forEach(item => item.classList.remove('active'));
                event.target.closest('.bottom-menu-item').classList.add('active');
            }
            
            switch(tab) {
                case 'exams':
                    viewAllExams();
                    break;
                case 'calendar':
                    showStudentCalendar();
                    break;
                case 'messages':
                    loadStudentMessages();
                    break;
            }
        }

        function showTeacherTab(tab, event) {
            if (event) {
                document.querySelectorAll('#teacherDashboard .bottom-menu-item').forEach(item => item.classList.remove('active'));
                event.target.closest('.bottom-menu-item').classList.add('active');
            }
            
            switch(tab) {
                case 'students':
                    loadStudents();
                    break;
                case 'attendance':
                    takeAttendance();
                    break;
                case 'exams':
                    showExamMarksModal();
                    break;
                case 'messages':
                    loadMessageStudentSelect();
                    loadSentMessages();
                    break;
                case 'fees':
                    updateFineStats();
                    break;
            }
        }

        function showParentTab(tab, event) {
            if (event) {
                document.querySelectorAll('#parentDashboard .bottom-menu-item').forEach(item => item.classList.remove('active'));
                event.target.closest('.bottom-menu-item').classList.add('active');
            }
            
            switch(tab) {
                case 'children':
                    loadChildren();
                    break;
                case 'messages':
                    loadParentMessages();
                    break;
                case 'results':
                    loadChildren();
                    break;
                case 'fees':
                    updateParentFinancialSummary();
                    break;
                case 'calendar':
                    if (currentUser.children && currentUser.children.length > 0) {
                        const firstChild = students.find(s => s.id === currentUser.children[0]);
                        if (firstChild) {
                            currentUser = { ...firstChild, type: 'student' };
                            showStudentCalendar();
                            currentUser = parents.find(p => p.id === currentUser.id);
                        }
                    }
                    break;
            }
        }
    </script>
</body>
</html>